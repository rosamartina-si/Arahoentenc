<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercici de Paraules</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; overflow: hidden; }
        canvas { background-color: #f0f0f0; display: block; }
        #inputContainer {
            position: fixed; bottom: 20px; left: 50%;
            transform: translateX(-50%); text-align: center;
        }
        input { font-size: 18px; padding: 10px; margin: 5px; width: 300px; }
        #feedback {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%); font-size: 32px; font-weight: bold; display: none;
        }
        .correct { color: green; }
        .incorrect { color: red; }
    </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="inputContainer">
    <input type="text" id="userInput" placeholder="Escriu cada paraula i prem Enter">
</div>
<div id="feedback"></div>

<script>

// El missatge inicial
alert(`üì¢ Benvingut al joc d'ortografia! ‚úèÔ∏è

üîπ Escriu cada paraula que baixa, amb accent quan calgui.
üîπ Escriu una paraula i prem Enter, despr√©s la seg√ºent, fins que hagis escrit totes les paraules que cauen.

üìñ Recorda aquestes regles b√†siques d'accentuaci√≥:
‚úÖ Accentuem les paraules agudes quan acaben en a, e, i, o, u, as, es, is, os, us, en, in.
   ‚ú®‚ö†Ô∏è Exemple: pet√≥ per√≤ petons, mat√≠ per√≤ matins.
   ‚ú®‚ö†Ô∏è Exemple: segon i segons, tobogan i tobogans.

üéØ Prepara't i molta sort! üçÄ`);

// Configuraci√≥ del canvas
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Llista completa de grups de paraules
const allWordGroups = [
    { words: ["accio", "accions"].sort(() => Math.random() - 0.5), solutions: ["acci√≥", "accions"] },
    { words: ["camio", "camions"].sort(() => Math.random() - 0.5), solutions: ["cami√≥", "camions"] },
    { words: ["basto", "bastons"].sort(() => Math.random() - 0.5), solutions: ["bast√≥", "bastons"] },
    { words: ["estacio", "estacions"].sort(() => Math.random() - 0.5), solutions: ["estaci√≥", "estacions"] },
    { words: ["relacio", "relacions"].sort(() => Math.random() - 0.5), solutions: ["relaci√≥", "relacions"] },
    { words: ["opinions", "opinio"].sort(() => Math.random() - 0.5), solutions: ["opinions", "opini√≥"] },
    { words: ["nacions", "nacio"].sort(() => Math.random() - 0.5), solutions: ["nacions", "naci√≥"] },
    { words: ["condicions", "condicio"].sort(() => Math.random() - 0.5), solutions: ["condicions", "condici√≥"] },
    { words: ["malson", "malsons"].sort(() => Math.random() - 0.5), solutions: ["malson", "malsons"] },
    { words: ["segon", "segons"].sort(() => Math.random() - 0.5), solutions: ["segon", "segons"] },
    { words: ["caiman", "caimans"].sort(() => Math.random() - 0.5), solutions: ["caiman", "caimans"] },
    { words: ["tobogan", "tobogans"].sort(() => Math.random() - 0.5), solutions: ["tobogan", "tobogans"] },
    { words: ["algun", "alguns"].sort(() => Math.random() - 0.5), solutions: ["algun", "alguns"] },
    { words: ["tauro", "taurons"].sort(() => Math.random() - 0.5), solutions: ["taur√≥", "taurons"] },
    { words: ["raco", "racons"].sort(() => Math.random() - 0.5), solutions: ["rac√≥", "racons"] },
    { words: ["nado", "nadons"].sort(() => Math.random() - 0.5), solutions: ["nad√≥", "nadons"] },
    { words: ["panta", "pantans"].sort(() => Math.random() - 0.5), solutions: ["pant√†", "pantans"] },
    { words: ["melo", "melons"].sort(() => Math.random() - 0.5), solutions: ["mel√≥", "melons"] },
    { words: ["definicio", "definicions"].sort(() => Math.random() - 0.5), solutions: ["definici√≥", "definicions"] },
    { words: ["situacio", "situacions"].sort(() => Math.random() - 0.5), solutions: ["situaci√≥", "situacions"] },
    { words: ["animacio", "animacions"].sort(() => Math.random() - 0.5), solutions: ["animaci√≥", "animacions"] },
    { words: ["aparicio", "aparicions"].sort(() => Math.random() - 0.5), solutions: ["aparici√≥", "aparicions"] },
    { words: ["atencio", "atencions"].sort(() => Math.random() - 0.5), solutions: ["atenci√≥", "atencions"] },
    { words: ["aviacio", "aviacions"].sort(() => Math.random() - 0.5), solutions: ["aviaci√≥", "aviacions"] },
    { words: ["celebracio", "celebracions"].sort(() => Math.random() - 0.5), solutions: ["celebraci√≥", "celebracions"] },
    { words: ["coccio", "coccions"].sort(() => Math.random() - 0.5), solutions: ["cocci√≥", "coccions"] },
    { words: ["creacio", "creacions"].sort(() => Math.random() - 0.5), solutions: ["creaci√≥", "creacions"] },
    { words: ["excursio", "excursions"].sort(() => Math.random() - 0.5), solutions: ["excursi√≥", "excursions"] },
    { words: ["missio", "missions"].sort(() => Math.random() - 0.5), solutions: ["missi√≥", "missions"] },
    { words: ["impressio", "impressions"].sort(() => Math.random() - 0.5), solutions: ["impressi√≥", "impressions"] },
    { words: ["tio", "tions"].sort(() => Math.random() - 0.5), solutions: ["ti√≥", "tions"] },
    { words: ["q√ºestio", "q√ºestions"].sort(() => Math.random() - 0.5), solutions: ["q√ºesti√≥", "q√ºestions"] },
    { words: ["agla", "aglans"].sort(() => Math.random() - 0.5), solutions: ["agl√†", "aglans"] },
    { words: ["content", "contents"].sort(() => Math.random() - 0.5), solutions: ["content", "contents"] },
    { words: ["casola", "casolans"].sort(() => Math.random() - 0.5), solutions: ["casol√†", "casolans"] },
    { words: ["huma", "humans"].sort(() => Math.random() - 0.5), solutions: ["hum√†", "humans"] },
    { words: ["italia", "italians"].sort(() => Math.random() - 0.5), solutions: ["itali√†", "italians"] },
    { words: ["llunya", "llunyans"].sort(() => Math.random() - 0.5), solutions: ["lluny√†", "llunyans"] },
    { words: ["ocea", "oceans"].sort(() => Math.random() - 0.5), solutions: ["oce√†", "oceans"] },
    { words: ["roma", "romans"].sort(() => Math.random() - 0.5), solutions: ["rom√†", "romans"] },
    { words: ["urba", "urbans"].sort(() => Math.random() - 0.5), solutions: ["urb√†", "urbans"] },
    { words: ["volca", "volcans"].sort(() => Math.random() - 0.5), solutions: ["volc√†", "volcans"] },
    { words: ["mati", "matins"].sort(() => Math.random() - 0.5), solutions: ["mat√≠", "matins"] },
    { words: ["mati", "matins"].sort(() => Math.random() - 0.5), solutions: ["mat√≠", "matins"] },
    { words: ["cami", "camins"].sort(() => Math.random() - 0.5), solutions: ["cam√≠", "camins"] },
    { words: ["coixi", "coixins"].sort(() => Math.random() - 0.5), solutions: ["coix√≠", "coixins"] },
    { words: ["intesti", "intestins"].sort(() => Math.random() - 0.5), solutions: ["intest√≠", "intestins"] },
    { words: ["jardi", "jardins"].sort(() => Math.random() - 0.5), solutions: ["jard√≠", "jardins"] },
    { words: ["moli", "molins"].sort(() => Math.random() - 0.5), solutions: ["mol√≠", "molins"] },
    { words: ["padri", "padrins"].sort(() => Math.random() - 0.5), solutions: ["padr√≠", "padrins"] },
    { words: ["ratoli", "ratolins"].sort(() => Math.random() - 0.5), solutions: ["ratol√≠", "ratolins"] },
    { words: ["violi", "violins"].sort(() => Math.random() - 0.5), solutions: ["viol√≠", "violins"] },
    { words: ["comu", "comuns"].sort(() => Math.random() - 0.5), solutions: ["com√∫", "comuns"] },
];

// Barregem tots els grups i nom√©s n'agafem 10
const wordGroups = allWordGroups.sort(() => Math.random() - 0.5).slice(0, 10);

// Variables de control
let fallingWords = [];
let currentGroupIndex = 0;
let userAnswers = [];
let gameFinished = false;   // Indica quan el joc finalitza
let score = 0;             // Contador de grups encertats

// Inicia un nou grup de paraules
function startNewWords() {
    if (currentGroupIndex < wordGroups.length) {
        const baseX = Math.random() * (canvas.width - 200);
        fallingWords = wordGroups[currentGroupIndex].words.map((word, i) => ({
            word,
            x: baseX,
            y: -30 - (i * 100)
        }));
        userAnswers = [];
        currentGroupIndex++;
    } else {
        // Quan hem exhaurit tots els grups, finalitzem
        finalizeGame();
    }
}

// Comprova la paraula de l'usuari
function checkAnswer() {
    const inputWord = userInput.value.trim();
    userAnswers.push(inputWord);

    // Un cop hem respost tantes paraules com cauen en aquest grup
    if (userAnswers.length === fallingWords.length) {
        const correctSolutions = wordGroups[currentGroupIndex - 1].solutions;
        const isCorrect = userAnswers.every(ans => correctSolutions.includes(ans));

        if (isCorrect) {
            showFeedback("Correcte!", "correct");
            score++; // augmenta puntuaci√≥ si tot el grup √©s correcte
        } else {
            showFeedback("Incorrecte! Era: " + correctSolutions.join(", "), "incorrect");
        }

        // Despr√©s d'uns segons, passem al seg√ºent grup o finalitzem el joc
        setTimeout(() => {
            if (currentGroupIndex < wordGroups.length) {
                startNewWords();
            } else {
                finalizeGame();
            }
        }, 2000);
    }
    userInput.value = "";
}

// Mostra missatges a la pantalla
function showFeedback(message, className) {
    const feedback = document.getElementById("feedback");
    feedback.innerText = message;
    feedback.className = className;
    feedback.style.display = "block";
    setTimeout(() => {
        feedback.style.display = "none";
    }, 2000);
}

// Quan hem acabat tots els grups
function finalizeGame() {
    // Marca el joc com finalitzat i neteja la pantalla
    gameFinished = true;
    fallingWords = []; // aix√≠ no es dibuixen m√©s paraules
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Mostra la puntuaci√≥ final
    showFeedback(`Joc completat! Has encertat ${score} de ${wordGroups.length} grups.`, "correct");
}

// Animaci√≥ de la caiguda de paraules
function updateGame() {
    // Si el joc s'ha acabat, no continuem
    if (gameFinished) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    fallingWords.forEach(obj => {
        obj.y += 0.5; // velocitat de caiguda
        ctx.font = "24px Arial";
        ctx.fillText(obj.word, obj.x, obj.y);
    });

    requestAnimationFrame(updateGame);
}

// Event listener per Enter a l'input
const userInput = document.getElementById("userInput");
userInput.addEventListener("keydown", event => {
    if (event.key === "Enter") checkAnswer();
});

// Quan es carrega la p√†gina, engeguem el joc
window.onload = () => {
    userInput.focus();
    startNewWords();
    updateGame();
};
</script>
</body>
</html>
