<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercici de Paraules</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; overflow: hidden; }
        canvas { background-color: #f0f0f0; display: block; }
        #inputContainer {
            position: fixed; bottom: 20px; left: 50%;
            transform: translateX(-50%); text-align: center;
        }
        input { font-size: 18px; padding: 10px; margin: 5px; width: 300px; }
        #feedback {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%); font-size: 32px; font-weight: bold; display: none;
        }
        .correct { color: green; }
        .incorrect { color: red; }
    </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="inputContainer">
    <input type="text" id="userInput" placeholder="Escriu cada paraula i prem Enter">
</div>
<div id="feedback"></div>

<script>

// El missatge inicial
alert(`ðŸ“¢ Benvingut al joc d'ortografia! âœï¸

ðŸ”¹ Escriu cada paraula que baixa, amb accent quan calgui.
ðŸ”¹ Escriu una paraula i prem Enter, desprÃ©s la segÃ¼ent, fins que hagis escrit totes les paraules que cauen.

ðŸ“– Recorda aquestes regles bÃ siques d'accentuaciÃ³:
âœ… Accentuem les paraules agudes quan acaben en a, e, i, o, u, as, es, is, os, us, en, in.
   âœ¨âš ï¸ Exemple: petÃ³ perÃ² petons, matÃ­ perÃ² matins.
   âœ¨âš ï¸ Exemple: segon i segons, tobogan i tobogans.

ðŸŽ¯ Prepara't i molta sort! ðŸ€`);

// ConfiguraciÃ³ del canvas
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Llista completa de grups de paraules
const allWordGroups = [
    { words: ["accio", "accions"].sort(() => Math.random() - 0.5), solutions: ["acciÃ³", "accions"] },
    { words: ["camio", "camions"].sort(() => Math.random() - 0.5), solutions: ["camiÃ³", "camions"] },
    { words: ["basto", "bastons"].sort(() => Math.random() - 0.5), solutions: ["bastÃ³", "bastons"] },
    { words: ["estacio", "estacions"].sort(() => Math.random() - 0.5), solutions: ["estaciÃ³", "estacions"] },
    { words: ["relacio", "relacions"].sort(() => Math.random() - 0.5), solutions: ["relaciÃ³", "relacions"] },
    { words: ["opinions", "opinio"].sort(() => Math.random() - 0.5), solutions: ["opinions", "opiniÃ³"] },
    { words: ["nacions", "nacio"].sort(() => Math.random() - 0.5), solutions: ["nacions", "naciÃ³"] },
    { words: ["condicions", "condicio"].sort(() => Math.random() - 0.5), solutions: ["condicions", "condiciÃ³"] },
    { words: ["malson", "malsons"].sort(() => Math.random() - 0.5), solutions: ["malson", "malsons"] },
    { words: ["segon", "segons"].sort(() => Math.random() - 0.5), solutions: ["segon", "segons"] },
    { words: ["caiman", "caimans"].sort(() => Math.random() - 0.5), solutions: ["caiman", "caimans"] },
    { words: ["tobogan", "tobogans"].sort(() => Math.random() - 0.5), solutions: ["tobogan", "tobogans"] },
    { words: ["algun", "alguns"].sort(() => Math.random() - 0.5), solutions: ["algun", "alguns"] },
    { words: ["tauro", "taurons"].sort(() => Math.random() - 0.5), solutions: ["taurÃ³", "taurons"] },
    { words: ["raco", "racons"].sort(() => Math.random() - 0.5), solutions: ["racÃ³", "racons"] },
    { words: ["nado", "nadons"].sort(() => Math.random() - 0.5), solutions: ["nadÃ³", "nadons"] },
    { words: ["panta", "pantans"].sort(() => Math.random() - 0.5), solutions: ["pantÃ ", "pantans"] },
    { words: ["melo", "melons"].sort(() => Math.random() - 0.5), solutions: ["melÃ³", "melons"] },
    { words: ["definicio", "definicions"].sort(() => Math.random() - 0.5), solutions: ["definiciÃ³", "definicions"] },
    { words: ["situacio", "situacions"].sort(() => Math.random() - 0.5), solutions: ["situaciÃ³", "situacions"] },
    { words: ["animacio", "animacions"].sort(() => Math.random() - 0.5), solutions: ["animaciÃ³", "animacions"] },
    { words: ["aparicio", "aparicions"].sort(() => Math.random() - 0.5), solutions: ["apariciÃ³", "aparicions"] },
    { words: ["atencio", "atencions"].sort(() => Math.random() - 0.5), solutions: ["atenciÃ³", "atencions"] },
    { words: ["aviacio", "aviacions"].sort(() => Math.random() - 0.5), solutions: ["aviaciÃ³", "aviacions"] },
    { words: ["celebracio", "celebracions"].sort(() => Math.random() - 0.5), solutions: ["celebraciÃ³", "celebracions"] },
    { words: ["coccio", "coccions"].sort(() => Math.random() - 0.5), solutions: ["cocciÃ³", "coccions"] },
    { words: ["creacio", "creacions"].sort(() => Math.random() - 0.5), solutions: ["creaciÃ³", "creacions"] },
    { words: ["excursio", "excursions"].sort(() => Math.random() - 0.5), solutions: ["excursiÃ³", "excursions"] },
    { words: ["missio", "missions"].sort(() => Math.random() - 0.5), solutions: ["missiÃ³", "missions"] },
    { words: ["impressio", "impressions"].sort(() => Math.random() - 0.5), solutions: ["impressiÃ³", "impressions"] },
    { words: ["tio", "tions"].sort(() => Math.random() - 0.5), solutions: ["tiÃ³", "tions"] },
    { words: ["qÃ¼estio", "qÃ¼estions"].sort(() => Math.random() - 0.5), solutions: ["qÃ¼estiÃ³", "qÃ¼estions"] },
    { words: ["agla", "aglans"].sort(() => Math.random() - 0.5), solutions: ["aglÃ ", "aglans"] },
    { words: ["content", "contents"].sort(() => Math.random() - 0.5), solutions: ["content", "contents"] },
    { words: ["casola", "casolans"].sort(() => Math.random() - 0.5), solutions: ["casolÃ ", "casolans"] },
    { words: ["huma", "humans"].sort(() => Math.random() - 0.5), solutions: ["humÃ ", "humans"] },
    { words: ["italia", "italians"].sort(() => Math.random() - 0.5), solutions: ["italiÃ ", "italians"] },
    { words: ["llunya", "llunyans"].sort(() => Math.random() - 0.5), solutions: ["llunyÃ ", "llunyans"] },
    { words: ["ocea", "oceans"].sort(() => Math.random() - 0.5), solutions: ["oceÃ ", "oceans"] },
    { words: ["roma", "romans"].sort(() => Math.random() - 0.5), solutions: ["romÃ ", "romans"] },
    { words: ["urba", "urbans"].sort(() => Math.random() - 0.5), solutions: ["urbÃ ", "urbans"] },
    { words: ["volca", "volcans"].sort(() => Math.random() - 0.5), solutions: ["volcÃ ", "volcans"] },
    { words: ["mati", "matins"].sort(() => Math.random() - 0.5), solutions: ["matÃ­", "matins"] },
    { words: ["mati", "matins"].sort(() => Math.random() - 0.5), solutions: ["matÃ­", "matins"] },
    { words: ["cami", "camins"].sort(() => Math.random() - 0.5), solutions: ["camÃ­", "camins"] },
    { words: ["coixi", "coixins"].sort(() => Math.random() - 0.5), solutions: ["coixÃ­", "coixins"] },
    { words: ["intesti", "intestins"].sort(() => Math.random() - 0.5), solutions: ["intestÃ­", "intestins"] },
    { words: ["jardi", "jardins"].sort(() => Math.random() - 0.5), solutions: ["jardÃ­", "jardins"] },
    { words: ["moli", "molins"].sort(() => Math.random() - 0.5), solutions: ["molÃ­", "molins"] },
    { words: ["padri", "padrins"].sort(() => Math.random() - 0.5), solutions: ["padrÃ­", "padrins"] },
    { words: ["ratoli", "ratolins"].sort(() => Math.random() - 0.5), solutions: ["ratolÃ­", "ratolins"] },
    { words: ["violi", "violins"].sort(() => Math.random() - 0.5), solutions: ["violÃ­", "violins"] },
    { words: ["comu", "comuns"].sort(() => Math.random() - 0.5), solutions: ["comÃº", "comuns"] },
];

// Barregem tots els grups i nomÃ©s n'agafem 10
const wordGroups = allWordGroups.sort(() => Math.random() - 0.5).slice(0, 10);

// Variables de control
let fallingWords = [];
let currentGroupIndex = 0;
let userAnswers = [];
let gameFinished = false;   // Indica quan el joc finalitza
let score = 0;             // Contador de grups encertats

// Inicia un nou grup de paraules
function startNewWords() {
    if (currentGroupIndex < wordGroups.length) {
        const baseX = Math.random() * (canvas.width - 200);
        fallingWords = wordGroups[currentGroupIndex].words.map((word, i) => ({
            word,
            x: baseX,
            y: -30 - (i * 100)
        }));
        userAnswers = [];
        currentGroupIndex++;
    } else {
        // Quan hem exhaurit tots els grups, finalitzem
        finalizeGame();
    }
}

// Comprova la paraula de l'usuari
function checkAnswer() {
    const inputWord = userInput.value.trim();
    userAnswers.push(inputWord);

    // Un cop hem respost tantes paraules com cauen en aquest grup
    if (userAnswers.length === fallingWords.length) {
        const correctSolutions = wordGroups[currentGroupIndex - 1].solutions;
        const isCorrect = userAnswers.every(ans => correctSolutions.includes(ans));

        if (isCorrect) {
            showFeedback("Correcte!", "correct");
            score++; // augmenta puntuaciÃ³ si tot el grup Ã©s correcte
        } else {
            showFeedback("Incorrecte! Era: " + correctSolutions.join(", "), "incorrect");
        }

        // DesprÃ©s d'uns segons, passem al segÃ¼ent grup o finalitzem el joc
        setTimeout(() => {
            if (currentGroupIndex < wordGroups.length) {
                startNewWords();
            } else {
                finalizeGame();
            }
        }, 2000);
    }
    userInput.value = "";
}

// Mostra missatges a la pantalla
function showFeedback(message, className) {
    const feedback = document.getElementById("feedback");
    feedback.innerText = message;
    feedback.className = className;
    feedback.style.display = "block";
    setTimeout(() => {
        feedback.style.display = "none";
    }, 2000);
}

// Quan hem acabat tots els grups
function finalizeGame() {
    // Marca el joc com finalitzat i neteja la pantalla
    gameFinished = true;
    fallingWords = []; // aixÃ­ no es dibuixen mÃ©s paraules
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Mostra la puntuaciÃ³ final
    showFeedback(`Joc completat! Has encertat ${score} de ${wordGroups.length} grups.`, "correct");
}

// AnimaciÃ³ de la caiguda de paraules
function updateGame() {
    // Si el joc s'ha acabat, no continuem
    if (gameFinished) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    fallingWords.forEach(obj => {
        obj.y += 0.5; // velocitat de caiguda
        ctx.font = "24px Arial";
        ctx.fillText(obj.word, obj.x, obj.y);
    });

    requestAnimationFrame(updateGame);
}

// Event listener per Enter a l'input
const userInput = document.getElementById("userInput");
userInput.addEventListener("keydown", event => {
    if (event.key === "Enter") checkAnswer();
});

// Quan es carrega la pÃ gina, engeguem el joc
window.onload = () => {
    userInput.focus();
    startNewWords();
    updateGame();
};
</script>
</body>
</html>
