<!-- /ui/sesamath012b-plus.html -->
<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fitxa Matem√†tiques 5√® ¬∑ S√®rie 1 ¬∑ Versi√≥ gamer</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    /* ========== Design tokens ========== */
    :root{
      --bg: #f7f7fb;
      --card: #ffffff;
      --text: #1c1d20;
      --muted: #666a73;
      --brand: #735cff;
      --brand-2: #00d4a6;
      --warn: #ffb020;
      --ok: #1ab45c;
      --err: #ff4d6d;
      --border: #e6e7ee;
      --radius: 16px;
      --shadow: 0 6px 18px rgba(22,25,40,.08);
      --font: "Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg: #0f1116;
        --card: #151822;
        --text: #e7e9ee;
        --muted: #a4adbd;
        --brand: #7b7bff;
        --brand-2: #20d6b8;
        --warn: #ffc36a;
        --ok: #26d07c;
        --err: #ff6b81;
        --border: #222738;
        --shadow: none;
      }
    }
    [data-theme="dark"]{
      --bg: #0f1116;
      --card: #151822;
      --text: #e7e9ee;
      --muted: #a4adbd;
      --border: #222738;
      --shadow: none;
    }

    /* ========== Base ========== */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text); font-family:var(--font);
      line-height:1.55; -webkit-font-smoothing:antialiased;
    }
    a{color:var(--brand); text-decoration:none}
    .container{max-width:1100px; margin-inline:auto; padding:20px}
    .sr-only{position:absolute; left:-9999px}

    /* ========== Header ========== */
    header.appbar{
      position:sticky; top:0; z-index:10; backdrop-filter:saturate(160%) blur(8px);
      background:color-mix(in srgb, var(--bg) 85%, transparent);
      border-bottom:1px solid var(--border);
    }
    .appbar-inner{
      display:flex; align-items:center; gap:12px; padding:12px 20px;
    }
    .brand{
      display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px;
      font-size:1.15rem;
    }
    .brand .logo{
      width:36px; aspect-ratio:1; border-radius:10px;
      background: radial-gradient(60% 60% at 30% 30%, var(--brand) 0%, var(--brand-2) 100%);
      box-shadow: inset 0 0 20px rgba(255,255,255,.2), var(--shadow);
    }
    .spacer{flex:1}
    .xp-badge{
      display:flex; align-items:center; gap:8px;
      padding:6px 10px; border:1px solid var(--border); border-radius:999px;
      background:var(--card); box-shadow:var(--shadow); font-variant-numeric:tabular-nums;
    }
    .toggle{
      appearance:none; width:50px; height:28px; border-radius:999px; position:relative;
      background:var(--border); cursor:pointer; outline:none; border:1px solid var(--border);
    }
    .toggle:after{
      content:""; position:absolute; inset:3px auto 3px 3px; width:22px; border-radius:50%;
      background:var(--card); transition:transform .25s ease;
      box-shadow:0 2px 8px rgba(0,0,0,.25);
    }
    .toggle:checked{background:linear-gradient(90deg, var(--brand) 0%, var(--brand-2) 100%)}
    .toggle:checked:after{transform:translateX(22px)}

    /* ========== Progress ========== */
    .progress{
      margin:16px 0 24px; background:var(--card); border:1px solid var(--border);
      border-radius:var(--radius); padding:14px; box-shadow:var(--shadow);
    }
    .progress-row{display:flex; align-items:center; gap:10px}
    .bar{
      position:relative; flex:1; height:12px; background:#e8ebf5; border-radius:999px; overflow:hidden;
      border:1px solid var(--border);
    }
    .bar > i{
      display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--brand),var(--brand-2));
      transition:width .3s ease;
    }
    .progress small{color:var(--muted)}

    /* ========== Cards/Sections ========== */
    section.card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
      padding:18px; margin:18px 0; box-shadow:var(--shadow);
    }
    .card h2{
      margin:0 0 12px; font-size:1.05rem; letter-spacing:.2px;
      display:flex; align-items:center; gap:8px;
    }
    .pill{
      display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px;
      font-size:.85rem; border:1px solid var(--border); background:color-mix(in srgb, var(--card) 92%, transparent);
    }

    /* ========== Tables / Grids ========== */
    table{
      width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px;
      border:1px solid var(--border);
    }
    th,td{padding:10px 12px; border-bottom:1px solid var(--border); text-align:center; vertical-align:middle}
    th{background:color-mix(in srgb, var(--card) 90%, var(--brand) 10%); font-weight:700}
    tr:last-child td{border-bottom:none}
    .grid{display:grid; gap:12px}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid.cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}
    @media (max-width:800px){ .grid.cols-6{grid-template-columns:repeat(3,1fr)} }
    @media (max-width:520px){ .grid.cols-3{grid-template-columns:repeat(2,1fr)} }

    /* ========== Inputs ========== */
    input[type="text"], input[type="number"], select{
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--border);
      background:var(--card); color:var(--text); font-size:1rem;
    }
    input[type="radio"], input[type="checkbox"]{width:20px; height:20px}
    .ghost-input{
      border:none; border-bottom:2px dotted color-mix(in srgb, var(--muted) 60%, transparent);
      border-radius:0; padding:4px 2px; background:transparent; width:80px; text-align:center;
    }
    .frac{
      display:inline-grid; grid-auto-flow:row; justify-items:center; align-items:center; font-variant-numeric:tabular-nums;
      margin:0 4px;
    }
    .frac .bar{width:100%; height:0; border-top:2px solid currentColor; margin:2px 0}
    .answer.ok{outline:2px solid var(--ok); outline-offset:2px}
    .answer.ko{outline:2px solid var(--err); outline-offset:2px}

    /* ========== Badges ========== */
    .hint{color:var(--muted); font-size:.95rem}
    .note{color:var(--muted); font-size:.9rem; text-align:center; margin:18px 0}

    /* ========== Footer actions ========== */
    .actions{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin:22px 0}
    .btn{
      border:1px solid var(--border); background:var(--card); padding:10px 14px; border-radius:12px;
      font-weight:700; cursor:pointer; box-shadow:var(--shadow)
    }
    .btn.primary{background:linear-gradient(90deg,var(--brand),var(--brand-2)); color:white; border:none}
    .btn.warn{background:linear-gradient(90deg,#ff9a3c,#ffd66b); color:#241a00; border:none}
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(0)}
    .status{min-height:24px; text-align:center}
    .status[aria-live]{padding:6px 10px}

    /* ========== Print ========== */
    @media print{
      header, .actions, .progress{display:none !important}
      section.card{box-shadow:none; border:1px solid #000}
      .answer.ok, .answer.ko{outline:none}
    }
  </style>
</head>
<body>
  <header class="appbar">
    <div class="appbar-inner container">
      <div class="brand" aria-label="Fitxa de matem√†tiques">
        <div class="logo" aria-hidden="true"></div>
        <span>S√®rie 1 ¬∑ Escriptures diferents</span>
        <span class="pill" title="Nivell">üßÆ 5√®</span>
      </div>
      <div class="spacer"></div>
      <div class="xp-badge" aria-live="polite" id="xpBadge">‚≠ê XP: <strong>0</strong></div>
      <label class="pill" for="themeToggle" title="Mode fosc/clar">üåô
        <input id="themeToggle" class="toggle" type="checkbox" aria-label="Canvia tema" />
      </label>
    </div>
  </header>

  <main class="container">
    <div class="progress" aria-label="Progr√©s">
      <div class="progress-row">
        <strong>Progr√©s</strong>
        <div class="bar" aria-hidden="true"><i id="progressFill"></i></div>
        <small id="progressText">0%</small>
      </div>
      <small class="hint">Completa camps i marca opcions per guanyar XP ‚ú®</small>
    </div>

    <!-- EX1 -->
    <section class="card" id="ex1">
      <h2>1 ¬∑ Nombre fraccionari <span class="pill">üéØ exacte o aproximat</span></h2>
      <p class="hint">Exemple: 5/3 = 1,66 √©s <em>aproximat</em>. 1,66 ha de ser el resultat de dividir 5 entre 3, per√≤ 1,66 √ó 3 = 4,98 i no √©s igual a 5. No hem obtingut una igualtat exacta, sin√≥ un valor decimal aproximat. Seguint aquest model, indica si els resultats s√≥n <strong>exactes</strong> o <strong>aproximats</strong>.</p>
      <div class="table-wrap">
        <table>
          <thead><tr>
            <th>Enunciat</th><th>Els teus c√†lculs</th><th>Exacte</th><th>Aproximat</th>
          </tr></thead>
          <tbody>
            <tr data-key="laura">
              <td>Laura: <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">3</span></span> = 0,33</td>
              <td><input type="text" inputmode="decimal" aria-label="C√†lcul Laura"></td>
              <td><input type="radio" name="laura" value="exacte"></td>
              <td><input type="radio" name="laura" value="aproximat"></td>
            </tr>
            <tr data-key="max">
              <td>Max: <span class="frac"><span class="num">4</span><span class="bar"></span><span class="den">5</span></span> = 0,8</td>
              <td><input type="text" inputmode="decimal" aria-label="C√†lcul Max"></td>
              <td><input type="radio" name="max" value="exacte"></td>
              <td><input type="radio" name="max" value="aproximat"></td>
            </tr>
            <tr data-key="abdou">
              <td>Abdou: <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den">8</span></span> = 0,12</td>
              <td><input type="text" inputmode="decimal" aria-label="C√†lcul Abdou"></td>
              <td><input type="radio" name="abdou" value="exacte"></td>
              <td><input type="radio" name="abdou" value="aproximat"></td>
            </tr>
            <tr data-key="emma">
              <td>Emma: <span class="frac"><span class="num">5</span><span class="bar"></span><span class="den">3</span></span> = 1,67</td>
              <td><input type="text" inputmode="decimal" aria-label="C√†lcul Emma"></td>
              <td><input type="radio" name="emma" value="exacte"></td>
              <td><input type="radio" name="emma" value="aproximat"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- EX2 -->
    <section class="card" id="ex2">
      <h2>2 ¬∑ Entre les fraccions seg√ºents <span class="pill">üß† decimals exactes?</span></h2>
      <p class="hint">Marca les que <strong>no tenen</strong> valor decimal exacte.</p>
      <div class="grid cols-6" id="ex2Grid" aria-label="Llista de fraccions">
        <!-- items -->
        <!-- data-num / data-den serveixen per validar -->
        <label class="card" style="padding:10px" aria-label="15 sobre 3">
          <div class="frac" data-num="15" data-den="3"><span class="num">15</span><span class="bar"></span><span class="den">3</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="8 sobre 10">
          <div class="frac" data-num="8" data-den="10"><span class="num">8</span><span class="bar"></span><span class="den">10</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="7 sobre 25">
          <div class="frac" data-num="7" data-den="25"><span class="num">7</span><span class="bar"></span><span class="den">25</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="3 sobre 15">
          <div class="frac" data-num="3" data-den="15"><span class="num">3</span><span class="bar"></span><span class="den">15</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="7 sobre 6">
          <div class="frac" data-num="7" data-den="6"><span class="num">7</span><span class="bar"></span><span class="den">6</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="25 sobre 4">
          <div class="frac" data-num="25" data-den="4"><span class="num">25</span><span class="bar"></span><span class="den">4</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="10 sobre 6">
          <div class="frac" data-num="10" data-den="6"><span class="num">10</span><span class="bar"></span><span class="den">6</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="10 sobre 30">
          <div class="frac" data-num="10" data-den="30"><span class="num">10</span><span class="bar"></span><span class="den">30</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="9 sobre 4">
          <div class="frac" data-num="9" data-den="4"><span class="num">9</span><span class="bar"></span><span class="den">4</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="6 sobre 10">
          <div class="frac" data-num="6" data-den="10"><span class="num">6</span><span class="bar"></span><span class="den">10</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="8 sobre 7">
          <div class="frac" data-num="8" data-den="7"><span class="num">8</span><span class="bar"></span><span class="den">7</span></div>
          <input type="checkbox" />
        </label>
        <label class="card" style="padding:10px" aria-label="30 sobre 10">
          <div class="frac" data-num="30" data-den="10"><span class="num">30</span><span class="bar"></span><span class="den">10</span></div>
          <input type="checkbox" />
        </label>
      </div>

      <p class="hint">Ara dona valors arrodonits als marcats:</p>
      <div class="grid cols-3">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="cent√®sim">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="cent√®sim">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="cent√®sim">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="cent√®sim">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="cent√®sim">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="cent√®sim">
      </div>

      <p class="hint">I a la unitat:</p>
      <div class="grid cols-3">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="unitat">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="unitat">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="unitat">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="unitat">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="unitat">
        <input class="ghost-input" type="text" inputmode="decimal" placeholder="unitat">
      </div>
    </section>

    <!-- EX3 -->
    <section class="card" id="ex3">
      <h2>3 ¬∑ Completa <span class="pill">‚úçÔ∏è escriu el nombre que falta</span></h2>
      <div class="grid cols-3">
        <div> a) <span class="frac"><span class="num"><input class="ghost-input" data-q="ex3a" aria-label="ex3a"></span><span class="bar"></span><span class="den">2</span></span> = 1 </div>
        <div> b) <span class="frac"><span class="num"><input class="ghost-input" data-q="ex3b"></span><span class="bar"></span><span class="den">3</span></span> = 4 </div>
        <div> c) <span class="frac"><span class="num"><input class="ghost-input" data-q="ex3c"></span><span class="bar"></span><span class="den">18</span></span> = 0 </div>
        <div> d) <span class="frac"><span class="num"><input class="ghost-input" data-q="ex3d"></span><span class="bar"></span><span class="den">3</span></span> = 10 </div>
        <div> e) <span class="frac"><span class="num">7</span><span class="bar"></span><span class="den"><input class="ghost-input" data-q="ex3e"></span></span> = 3,5 </div>
        <div> f) <span class="frac"><span class="num">1</span><span class="bar"></span><span class="den"><input class="ghost-input" data-q="ex3f"></span></span> = 0,1 </div>
        <div> g) 3 = <span class="frac"><span class="num">9</span><span class="bar"></span><span class="den"><input class="ghost-input" data-q="ex3g"></span></span> </div>
        <div> h) 3 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex3h"></span><span class="bar"></span><span class="den">9</span></span> </div>
        <div> i) 9 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex3i"></span><span class="bar"></span><span class="den">3</span></span> </div>
      </div>
    </section>

    <!-- EX4 -->
    <section class="card" id="ex4">
      <h2>4 ¬∑ Naturalesa i forma decimal <span class="pill">üîé classifica</span></h2>
      <table>
        <thead><tr><th>Nombre</th><th>Natura</th><th>Escriptura decimal</th></tr></thead>
        <tbody>
          <tr>
            <td><span class="frac"><span class="num">9</span><span class="bar"></span><span class="den">6</span></span></td>
            <td>
              <label><input type="checkbox"> enter</label>
              <label><input type="checkbox"> decimal exacte</label>
              <label><input type="checkbox"> decimal peri√≤dic</label>
            </td>
            <td><input class="ghost-input" type="text" aria-label="9/6 decimal"></td>
          </tr>
          <tr>
            <td><span class="frac"><span class="num">12</span><span class="bar"></span><span class="den">7</span></span></td>
            <td>
              <label><input type="checkbox"> enter</label>
              <label><input type="checkbox"> decimal exacte</label>
              <label><input type="checkbox"> decimal peri√≤dic</label>
            </td>
            <td><input class="ghost-input" type="text" aria-label="12/7 decimal"></td>
          </tr>
          <tr>
            <td><span class="frac"><span class="num">36</span><span class="bar"></span><span class="den">4</span></span></td>
            <td>
              <label><input type="checkbox"> enter</label>
              <label><input type="checkbox"> decimal exacte</label>
              <label><input type="checkbox"> decimal peri√≤dic</label>
            </td>
            <td><input class="ghost-input" type="text" aria-label="36/4 decimal"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- EX5 -->
    <section class="card" id="ex5">
      <h2>5 ¬∑ Per quin nombre cal‚Ä¶ <span class="pill">üß© factor</span></h2>
      <div class="grid cols-3">
        <div>a) multiplicar 5 per obtenir 3? <span class="frac"><span class="num"><input class="ghost-input" data-q="ex5aN"></span><span class="bar"></span><span class="den"><input class="ghost-input" data-q="ex5aD"></span></span></div>
        <div>b) multiplicar 19 per obtenir 97? <span class="frac"><span class="num"><input class="ghost-input" data-q="ex5bN"></span><span class="bar"></span><span class="den"><input class="ghost-input" data-q="ex5bD"></span></span></div>
        <div>c) multiplicar 12 per obtenir 11? <span class="frac"><span class="num"><input class="ghost-input" data-q="ex5cN"></span><span class="bar"></span><span class="den"><input class="ghost-input" data-q="ex5cD"></span></span></div>
      </div>
    </section>

    <!-- EX6 -->
    <section class="card" id="ex6">
      <h2>6 ¬∑ Completa amb el nombre que falta <span class="pill">üßÆ proporcions</span></h2>
      <div class="grid cols-3">
        <div>a) 68 √ó <span class="frac"><span class="num"><input class="ghost-input" data-q="ex6aN"></span><span class="bar"></span><span class="den">68</span></span> = 52</div>
        <div>b) <span class="frac"><span class="num">57</span><span class="bar"></span><span class="den">90</span></span> √ó <input class="ghost-input" data-q="ex6b"> = 57</div>
        <div>c) <input class="ghost-input" data-q="ex6c"> √ó <span class="frac"><span class="num">9</span><span class="bar"></span><span class="den">85</span></span> = 9</div>
        <div>d) <span class="frac"><span class="num"><input class="ghost-input" data-q="ex6dN"></span><span class="bar"></span><span class="den">59</span></span> √ó 59 = 17</div>
      </div>
    </section>

    <!-- EX7 -->
    <section class="card" id="ex7">
      <h2>7 ¬∑ Completa <span class="pill">üü∞ equival√®ncies</span></h2>
      <div class="grid cols-3">
        <div>a) 3 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex7a"></span><span class="bar"></span><span class="den">2</span></span></div>
        <div>b) 5 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex7b"></span><span class="bar"></span><span class="den">2</span></span></div>
        <div>c) 4,5 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex7c"></span><span class="bar"></span><span class="den">2</span></span></div>
        <div>d) 11,5 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex7d"></span><span class="bar"></span><span class="den">2</span></span></div>
        <div>e) 12 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex7e"></span><span class="bar"></span><span class="den">2</span></span></div>
        <div>f) 15,5 = <span class="frac"><span class="num"><input class="ghost-input" data-q="ex7f"></span><span class="bar"></span><span class="den">2</span></span></div>
      </div>
    </section>

    <!-- EX8 -->
    <section class="card" id="ex8">
      <h2>8 ¬∑ Percentatge ‚Üí fracci√≥ <span class="pill">üìä tria</span></h2>
      <div class="grid cols-3">
        <!-- Cada select te data-answer amb la soluci√≥ correcta -->
        <label> a) 100 % 
          <select data-answer="1">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
        <label> b) 25 % 
          <select data-answer="1/4">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
        <label> c) 20 % 
          <select data-answer="1/5">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
        <label> d) 1 % 
          <select data-answer="1/100">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
        <label> e) 5 % 
          <select data-answer="1/20">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
        <label> f) 80 % 
          <select data-answer="4/5">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
        <label> g) 60 % 
          <select data-answer="3/5">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
        <label> h) 2 % 
          <select data-answer="1/50">
            <option value="">--</option>
            <option>1/100</option><option>1/50</option><option>1/5</option><option>1/20</option>
            <option>1/4</option><option>3/5</option><option>4/5</option><option>1</option>
          </select>
        </label>
      </div>
    </section>

    <div class="actions">
      <button class="btn primary" id="checkBtn">Comprova ‚úÖ</button>
      <button class="btn" id="resetBtn">Reinicia ‚ôªÔ∏è</button>
      <button class="btn warn" onclick="window.print()">Imprimeix üñ®Ô∏è</button>
    </div>
    <div class="status" aria-live="polite" id="statusArea"></div>

    <p class="note">Fitxa de matem√†tiques per a 5√® de prim√†ria ‚Äî S√®rie 1 (versi√≥ millorada gamer)</p>
  </main>

  <script>
    // ===== Utils =====
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    const clamp = (n, a, b) => Math.max(a, Math.min(b, n));

    // Tema
    const themeToggle = $('#themeToggle');
    const root = document.documentElement;
    const savedTheme = localStorage.getItem('theme');
    if(savedTheme === 'dark'){ root.setAttribute('data-theme','dark'); themeToggle.checked = true; }
    themeToggle.addEventListener('change', () => {
      if(themeToggle.checked){ root.setAttribute('data-theme','dark'); localStorage.setItem('theme','dark'); }
      else { root.removeAttribute('data-theme'); localStorage.setItem('theme','light'); }
    });

    // Barra de progr√©s
    const progressFill = $('#progressFill');
    const progressText = $('#progressText');
    const inputs = $$('input, select').filter(el => !['radio','checkbox'].includes(el.type) || el.closest('table, .grid, label'));
    const updaters = ['input','change'];
    updaters.forEach(evt => document.addEventListener(evt, updateProgress));
    function updateProgress(){
      const allFillables = $$('input[type="text"], input[type="number"], select, input[type="radio"], input[type="checkbox"]');
      const total = allFillables.length;
      const filled = allFillables.filter(el=>{
        if(el.type==='radio'){
          const group = $$(`input[type="radio"][name="${el.name}"]`);
          return group.some(r=>r.checked);
        }
        if(el.type==='checkbox') return el.checked;
        if(el.tagName==='SELECT') return el.value !== '';
        return el.value.trim()!==''; 
      }).length;
      const pct = Math.round((filled/total)*100);
      progressFill.style.width = pct + '%';
      progressText.textContent = pct + '%';
    }
    updateProgress();

    // XP (gamificaci√≥ senzilla)
    let xp = 0;
    const xpBadge = $('#xpBadge strong');
    function addXP(n){ xp = clamp(xp + n, 0, 9999); xpBadge.textContent = xp; }

    // ===== Validacions simples =====
    const statusArea = $('#statusArea');

    // EX1: exactes/aproximats
    // claus correctes: laura=aproximat, max=exacte, abdou=aproximat, emma=aproximat
    const ex1Key = { laura:'aproximat', max:'exacte', abdou:'aproximat', emma:'aproximat' };
    function checkEx1(){
      let ok=0, total=4;
      Object.entries(ex1Key).forEach(([k,v])=>{
        const row = document.querySelector(`tr[data-key="${k}"]`);
        const picked = $(`input[type="radio"][name="${k}"]:checked`, row);
        const cells = $$('td', row);
        cells.forEach(td=>td.classList.remove('ok','ko','answer'));
        if(picked){
          const correct = picked.value===v;
          (correct?ok:0);
          if(correct){ cells.forEach(td=>td.classList.add('answer','ok')); ok++; addXP(2); }
          else { cells.forEach(td=>td.classList.add('answer','ko')); }
        }
      });
      return ok===total;
    }

    // EX2: decimal exacte si, redu√Øt, el denominador nom√©s t√© factors 2 i/o 5
    function gcd(a,b){ return b?gcd(b,a%b):Math.abs(a); }
    function hasOnly2and5(n){
      n=Math.abs(n);
      if(n===0) return false;
      while(n%2===0) n/=2;
      while(n%5===0) n/=5;
      return n===1;
    }
    function checkEx2(){
      let allOk = true;
      $$('#ex2Grid label').forEach(lab=>{
        const f = $('.frac', lab);
        const num = +f.dataset.num, den = +f.dataset.den;
        const g = gcd(num,den);
        const rDen = den/g;
        const shouldMark = !hasOnly2and5(rDen); // NO decimal exacte
        const checked = $('input[type="checkbox"]', lab).checked;
        lab.classList.remove('answer','ok','ko');
        const correct = (checked === shouldMark);
        if(correct){ lab.classList.add('answer','ok'); addXP(1); }
        else { lab.classList.add('answer','ko'); allOk=false; }
      });
      return allOk;
    }

    // EX8: mapa percent‚Üífracci√≥ segons data-answer
    function checkEx8(){
      let ok=true;
      $$('#ex8 select').forEach(sel=>{
        const ans = sel.dataset.answer;
        const value = sel.value;
        sel.classList.remove('answer','ok','ko');
        if(value===''){ ok=false; return; }
        const correct = value===ans;
        sel.classList.add('answer', correct?'ok':'ko');
        if(correct) addXP(1);
        else ok=false;
      });
      return ok;
    }

    // Les altres: es consideren "OK" si estan omplertes (per incentivar completar)
    function checkFilled(scope){
      let ok=true;
      $$('#'+scope+' input[type="text"], #'+scope+' input[type="number"], #'+scope+' select').forEach(inp=>{
        const filled = (inp.value || '').trim() !== '';
        inp.classList.remove('answer','ok','ko');
        if(filled){ inp.classList.add('answer','ok'); addXP(.2); }
        else { inp.classList.add('answer','ko'); ok=false; }
      });
      return ok;
    }

    // Botons
    $('#checkBtn').addEventListener('click', ()=>{
      const results = [];
      results.push(['Ex1', checkEx1()]);
      results.push(['Ex2', checkEx2()]);
      results.push(['Ex3', checkFilled('ex3')]);
      results.push(['Ex4', checkFilled('ex4')]);
      results.push(['Ex5', checkFilled('ex5')]);
      results.push(['Ex6', checkFilled('ex6')]);
      results.push(['Ex7', checkFilled('ex7')]);
      results.push(['Ex8', checkEx8()]);
      updateProgress();

      const passed = results.filter(([,ok])=>ok).length;
      const total = results.length;
      statusArea.textContent = `Resultat: ${passed}/${total} exercicis correctes o completats. üéâ`;
      if(passed===total){
        // confeti minimalista
        try{ document.startViewTransition?.(()=>{}) }catch(e){}
        addXP(10);
      }else{
        if('vibrate' in navigator) navigator.vibrate(80);
      }
    });

    $('#resetBtn').addEventListener('click', ()=>{
      $$('input[type="text"], input[type="number"]').forEach(i=>i.value='');
      $$('input[type="radio"]').forEach(r=>r.checked=false);
      $$('input[type="checkbox"]').forEach(c=>c.checked=false);
      $$('select').forEach(s=>s.value='');
      $$('.answer').forEach(a=>a.classList.remove('answer','ok','ko'));
      xp = 0; xpBadge.textContent = xp;
      statusArea.textContent = '';
      updateProgress();
      window.scrollTo({top:0, behavior:'smooth'});
    });

    // Focus nice-to-have
    document.addEventListener('keydown', (e)=>{
      if(e.key==='/' && !e.target.matches('input,select,textarea')){
        const first = $('input,select');
        if(first){ first.focus(); e.preventDefault(); }
      }
    });
  </script>
</body>
</html>
