<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conjugador de Verbs Catalans - 1a Conjugaci√≥</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #2ecc71;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .app-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }
        
        .input-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .result-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: auto;
            max-height: 70vh;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .verb-examples {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .verb-example {
            background: var(--light);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .verb-example:hover {
            background: var(--secondary);
            color: white;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .verb-title {
            font-size: 1.8rem;
            color: var(--primary);
        }
        
        .conjugation-type {
            background: var(--light);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .conjugation-section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 1.2rem;
            color: var(--secondary);
            margin-bottom: 12px;
            padding-bottom: 5px;
            border-bottom: 1px dashed #eee;
        }
        
        .conjugation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .conjugation-item {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid var(--secondary);
        }
        
        .pronoun {
            font-weight: 600;
            color: var(--dark);
        }
        
        .conjugated-form {
            margin-left: 5px;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--secondary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-message {
            background: #ffeaa7;
            color: #d63031;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-secondary {
            background: var(--light);
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background: #d5dbdb;
        }
        
        .history-panel {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .history-title {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .history-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .history-item {
            background: var(--light);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 13px;
            cursor: pointer;
        }
        
        .history-item:hover {
            background: #d5dbdb;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: white;
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .conjugation-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .conjugation-table th,
        .conjugation-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .conjugation-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--primary);
        }
        
        .conjugation-table tr:hover {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Conjugador de Verbs Catalans</h1>
            <p class="subtitle">1a Conjugaci√≥ - Verbs en -ar</p>
        </header>
        
        <div class="app-container">
            <div class="input-panel">
                <div class="form-group">
                    <label for="verbInput">Verb en infinitiu (acabat en -ar)</label>
                    <input type="text" id="verbInput" placeholder="Ex: cantar, menjar, estar...">
                </div>
                
                <div class="form-group">
                    <label>Exemples r√†pids</label>
                    <div class="verb-examples">
                        <div class="verb-example" data-verb="cantar">cantar</div>
                        <div class="verb-example" data-verb="menjar">menjar</div>
                        <div class="verb-example" data-verb="estar">estar</div>
                        <div class="verb-example" data-verb="sacar">sacar</div>
                        <div class="verb-example" data-verb="regar">regar</div>
                        <div class="verb-example" data-verb="canviar">canviar</div>
                    </div>
                </div>
                
                <button id="conjugateBtn">
                    <span>Conjuga</span>
                </button>
                
                <div class="action-buttons">
                    <button id="clearBtn" class="btn-secondary">
                        <span>Neteja</span>
                    </button>
                </div>
                
                <div class="history-panel">
                    <div class="history-title">Historial</div>
                    <div class="history-list" id="historyList">
                        <!-- Historial es generar√† din√†micament -->
                    </div>
                </div>
            </div>
            
            <div class="result-panel">
                <div class="error-message" id="errorMessage"></div>
                
                <div class="loading" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p>Conjugant el verb...</p>
                </div>
                
                <div id="conjugationResult">
                    <div class="empty-state">
                        <i>üìù</i>
                        <h3>Introdueix un verb per comen√ßar</h3>
                        <p>Escriu un verb en infinitiu acabat en -ar al camp de l'esquerra</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Conjugador de verbs catalans &copy; 2023 - 1a conjugaci√≥ (-ar)</p>
        </footer>
    </div>

    <script>
        // Definim els pronoms una vegada per a tot el programa
        const PRONOMS = ['jo', 'tu', 'ell/ella/vost√®', 'nosaltres', 'vosaltres/v√≥s', 'ells/elles/vost√®s'];
        const PRONOMS_IMPERATIU = ['tu', 'ell/ella/vost√®', 'nosaltres', 'vosaltres', 'ells/elles/vost√®s'];

        // Variable global per emmagatzemar el text
        let conjugationHistory = [];
        
        // Elements del DOM
        const verbInput = document.getElementById('verbInput');
        const conjugateBtn = document.getElementById('conjugateBtn');
        const clearBtn = document.getElementById('clearBtn');
        const conjugationResult = document.getElementById('conjugationResult');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const errorMessage = document.getElementById('errorMessage');
        const historyList = document.getElementById('historyList');
        const verbExamples = document.querySelectorAll('.verb-example');
        
        // Inicialitzaci√≥
        document.addEventListener('DOMContentLoaded', function() {
            loadHistory();
            setupEventListeners();
        });
        
        // Configuraci√≥ dels event listeners
        function setupEventListeners() {
            conjugateBtn.addEventListener('click', conjugateVerb);
            clearBtn.addEventListener('click', clearInput);
            verbInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') conjugateVerb();
            });
            
            // Exemples r√†pids
            verbExamples.forEach(example => {
                example.addEventListener('click', function() {
                    verbInput.value = this.getAttribute('data-verb');
                    conjugateVerb();
                });
            });
        }
        
        // Funci√≥ principal de conjugaci√≥
        function conjugateVerb() {
            const verb = verbInput.value.trim().toLowerCase();
            
            if (!verb) {
                showError('Si us plau, introdueix un verb');
                return;
            }
            
            if (!verb.endsWith('ar')) {
                showError('Aquest conjugador nom√©s funciona per a verbs de la 1a conjugaci√≥ (acabats en -ar)');
                return;
            }
            
            // Amaga errors i mostra l'indicador de c√†rrega
            hideError();
            showLoading();
            
            // Processem el verb
            try {
                const resultat = conjugaVerb(verb);
                
                // Mostrem el resultat
                mostrarResultat(verb, resultat);
                
                // Afegim a l'historial
                addToHistory(verb);
                
            } catch (error) {
                showError('Error en conjugar el verb: ' + error.message);
                console.error(error);
            } finally {
                hideLoading();
            }
        }
        
        // FUNCIONS DE CONJUGACI√ì
        
function corregeixOrtografia(forma, verb, temps = '') {
    // 1. PRIMER les substitucions espec√≠fiques
    let formaCorregida = forma
        .replace(/je/g, 'ge') // je ‚Üí ge
        .replace(/j√©/g, 'g√©') // j√© ‚Üí g√©
        .replace(/ji/g, 'gi') // ji ‚Üí gi
        .replace(/j√≠/g, 'g√≠') // j√≠ ‚Üí g√≠
        .replace(/√ß√ße/g, 'ce') // √ß√ße ‚Üí ce
        .replace(/√ß√ß√©/g, 'c√©') // √ß√ß√© ‚Üí c√©
        .replace(/√ß√ß√≠/g, 'c√≠') // √ß√ß√≠ ‚Üí c√≠
        .replace(/√ß√ßi/g, 'ci') // √ß√ßi ‚Üí ci
        .replace(/cce/g, 'que') // cce ‚Üí que
        .replace(/cc√©/g, 'qu√©') // cc√© ‚Üí qu√©
        .replace(/cc√≠/g, 'qu√≠') // cc√≠ ‚Üí qu√≠
        .replace(/cci/g, 'qui') // cci ‚Üí qui
        .replace(/gge/g, 'gue') // gge ‚Üí gue
        .replace(/gg√©/g, 'gu√©') // gg√© ‚Üí gu√©
        .replace(/ggi/g, 'gui') // ggi ‚Üí gui
        .replace(/gg√≠/g, 'gu√≠') // gg√≠ ‚Üí gu√≠
        .replace(/g√ºa/g, 'gua') // g√ºa ‚Üí gua
        .replace(/g√º√†/g, 'gu√†') // g√º√† ‚Üí gu√†
        .replace(/g√ºo/g, 'guo') // g√ºo ‚Üí guo
        .replace(/q√ºa/g, 'qua') // q√ºa ‚Üí qua
        .replace(/q√º√†/g, 'qu√†') // q√º√† ‚Üí qu√†
        .replace(/q√ºo/g, 'quo') // q√ºo ‚Üí quo
        .replace(/ayi/g, 'a√Ø')  // ayi ‚Üí a√Ø
        .replace(/eyi/g, 'e√Ø')  // eyi ‚Üí e√Ø
        .replace(/iyi/g, 'i√Ø')  // iyi ‚Üí i√Ø
        .replace(/oyi/g, 'o√Ø')  // oyi ‚Üí o√Ø
        .replace(/uyi/g, 'u√Ø'); // uyi ‚Üí u√Ø
    
    // 2. Correccions per a verbs irregulars
    if (verb === 'aguar') {
        formaCorregida = formaCorregida
            .replace(/aguo/g, 'ag√∫o')
            .replace(/ag√ºes/g, 'ag√∫es')
            .replace(/^agua$/g, 'ag√∫a')        // nom√©s quan sigui exactament "agua" 
            .replace(/ag√ºen/g, 'ag√∫en')
            .replace(/ag√ºi/g, 'agu√Ø')
            .replace(/ag√ºis/g, 'agu√Øs')
            .replace(/ag√ºin/g, 'agu√Øn');
    }
    
    if (verb === 'estar') {
        // Substituccions generals (sense ^ i $ per ser m√©s flexibles) ***

    if (temps === 'present') {
        formaCorregida = formaCorregida
            .replace(/^esto$/g, 'estic')
            .replace(/^estes$/g, 'est√†s')  
            .replace(/^esta$/g, 'est√†')
            .replace(/^esten$/g, 'estan');
    }

    else if (temps === 'passatSimple') {
        formaCorregida = formaCorregida         
            .replace(/^est√≠$/g, 'estigu√≠')
            .replace(/^estares$/g, 'estigueres')
            .replace(/^est√†$/g, 'estigu√©')
            .replace(/^est√†rem$/g, 'estigu√©rem')
            .replace(/^est√†reu$/g, 'estigu√©reu')
            .replace(/^estaren$/g, 'estigueren');
    }
        
        else if (temps === 'subjuntiuPresent') {
            formaCorregida = formaCorregida
                .replace(/^esti$/g, 'estigui')
                .replace(/^estis$/g, 'estiguis')
                .replace(/^esteu$/g, 'estigueu')
                .replace(/^estem$/g, 'estiguem')
                .replace(/^estin$/g, 'estiguin'); 
        }
        
        else if (temps === 'imperatiu') {
            formaCorregida = formaCorregida
                .replace(/^esta$/g, 'estigues')
                .replace(/^esti$/g, 'estigui')
                .replace(/^estem$/g, 'estiguem')
                .replace(/^esteu$/g, 'estigueu')
                .replace(/^estin$/g, 'estiguin'); 
        }
    }

    if (verb === 'anar') {
        // Substituccions generals (sense ^ i $ per ser m√©s flexibles) *** 'imperfet'

    if (temps === 'present') {
        formaCorregida = formaCorregida
            .replace(/^ano$/g, 'vaig')
            .replace(/^anes$/g, 'vas')  
            .replace(/^ana$/g, 'va')
            .replace(/^anen$/g, 'van');
    }


    else if (temps === 'futur') {
        formaCorregida = formaCorregida         
            .replace(/^anar√©$/g, 'anir√©')
            .replace(/^anar√†s$/g, 'anir√†s')
            .replace(/^anar√†$/g, 'anir√†')
            .replace(/^anarem$/g, 'anirem')
            .replace(/^anareu$/g, 'anireu')
            .replace(/^anaran$/g, 'aniran');
    }
        
        else if (temps === 'subjuntiuPresent') {
            formaCorregida = formaCorregida
                .replace(/^ani$/g, 'vagi')
                .replace(/^anis$/g, 'vagis')
                .replace(/^anin$/g, 'vagin'); 
        }
        
        else if (temps === 'imperatiu') {
            formaCorregida = formaCorregida
                .replace(/^ana$/g, 'ves')
                .replace(/^ani$/g, 'vagi')
                .replace(/^anin$/g, 'vagin'); 
        }
    }

    if (verb === 'ser') {
        formaCorregida = formaCorregida
            .replace(/so/g, 'soc')
            .replace(/ses/g, 'ets')
            .replace(/se/g, '√©s')
            .replace(/sem/g, 'som')
            .replace(/seu/g, 'sou')
            .replace(/sen/g, 's√≥n');
    }

    
    // 3. DESPR√âS les eliminacions de duplicacions
    formaCorregida = formaCorregida
        .replace(/cc/g, 'c')
        .replace(/gg/g, 'g')
        .replace(/√ß√ß/g, '√ß')
        .replace(/ay/g, 'a')
        .replace(/ey/g, 'e')
        .replace(/iy/g, 'i')
        .replace(/oy/g, 'o')
        .replace(/uy/g, 'u');
    
    return formaCorregida;
}
        
function corregeixOrtografiaResultat(resultat, verb) {
    Object.keys(resultat).forEach(temps => {
        if (Array.isArray(resultat[temps])) {
            resultat[temps] = resultat[temps].map(item => ({
                ...item,
                forma: corregeixOrtografia(item.forma, verb, temps) // Passem el temps directament
            }));
        } else if (typeof resultat[temps] === 'object') {
            if (resultat[temps].infinitiu) {
                resultat[temps].infinitiu.forma = corregeixOrtografia(resultat[temps].infinitiu.forma, verb, 'infinitiu');
            }
            if (resultat[temps].gerundi) {
                resultat[temps].gerundi.forma = corregeixOrtografia(resultat[temps].gerundi.forma, verb, 'gerundi');
            }
            if (Array.isArray(resultat[temps].participi)) {
                resultat[temps].participi = resultat[temps].participi.map(item => ({
                    ...item,
                    forma: corregeixOrtografia(item.forma, verb, 'participi')
                }));
            }
        }
    });
    
    return resultat;
}
        
        function conjugaPresent(radical, conjugacio) {
            let formes = [];
            
            switch(conjugacio) {
                case 'ar': 
                    formes = [radical + 'o', radical + 'es', radical + 'a', 
                             radical + 'em', radical + 'eu', radical + 'en'];
                    break;
                default: 
                    formes = [];
            }
            
            return formes.map((forma, index) => ({
                etiqueta: PRONOMS[index],
                forma: forma,
                temps: 'present'
            }));
        }
        
        function conjugaImperfet(radical, conjugacio) {
            let formes = [];
            
            switch(conjugacio) {
                case 'ar': 
                    formes = [radical + 'ava', radical + 'aves', radical + 'ava', 
                             radical + '√†vem', radical + '√†veu', radical + 'aven'];
                    break;
                default: 
                    formes = [];
            }
            
            return formes.map((forma, index) => ({
                etiqueta: PRONOMS[index],
                forma: forma,
                temps: 'imperfet'
            }));
        }



function conjugaPassatSimple(radical, conjugacio) {
    let formes = [];
    
    switch(conjugacio) {
        case 'ar': 
            formes = [radical + '√≠', radical + 'ares', radical + '√†', 
                     radical + '√†rem', radical + '√†reu', radical + 'aren'];
            break;
        default: 
            formes = [];
    }
    
    return formes.map((forma, index) => ({
        etiqueta: PRONOMS[index],
        forma: forma,
        temps: 'passatSimple'
    }));
}



        
        function conjugaFutur(radical, conjugacio) {
            let formes = [];
            
            switch(conjugacio) {
                case 'ar': 
                    formes = [radical + 'ar√©', radical + 'ar√†s', radical + 'ar√†', 
                             radical + 'arem', radical + 'areu', radical + 'aran'];
                    break;
                default: 
                    formes = [];
            }
            
            return formes.map((forma, index) => ({
                etiqueta: PRONOMS[index],
                forma: forma,
                temps: 'futur'
            }));
        }
        
        function conjugaCondicional(radical, conjugacio) {
            let formes = [];
            
            switch(conjugacio) {
                case 'ar': 
                    formes = [radical + 'aria', radical + 'aries', radical + 'aria', 
                             radical + 'ar√≠em', radical + 'ar√≠eu', radical + 'arien'];
                    break;
                default: 
                    formes = [];
            }
            
            return formes.map((forma, index) => ({
                etiqueta: PRONOMS[index],
                forma: forma,
                temps: 'condicional'
            }));
        }
        
        function conjugaSubjuntiuPresent(radical, conjugacio) {
            let formes = [];
            
            switch(conjugacio) {
                case 'ar': 
                    formes = [radical + 'i', radical + 'is', radical + 'i', 
                             radical + 'em', radical + 'eu', radical + 'in'];
                    break;
                default: 
                    formes = [];
            }
            
            return formes.map((forma, index) => ({
                etiqueta: PRONOMS[index],
                forma: forma,
                temps: 'subjuntiuPresent'
            }));
        }
        
        function conjugaImperatiu(radical, conjugacio) {
            let formes = [];
            
            switch(conjugacio) {
                case 'ar': 
                    formes = [radical + 'a', radical + 'i', 
                             radical + 'em', radical + 'eu', radical + 'in'];
                    break;
                default: 
                    formes = [];
            }
            
            return formes.map((forma, index) => ({
                etiqueta: PRONOMS_IMPERATIU[index],
                forma: forma,
                temps: 'imperatiu'
            }));
        }
        
        function conjugaFormesNominals(radical, conjugacio) {
            let formes = {};
            
            switch(conjugacio) {
                case 'ar': 
                    formes = {
                        infinitiu: { etiqueta: 'infinitiu', forma: radical + 'ar' },
                        gerundi: { etiqueta: 'gerundi', forma: radical + 'ant' },
                        participi: [
                            { etiqueta: 'participi mascul√≠ singular', forma: radical + 'at' },
                            { etiqueta: 'participi mascul√≠ plural', forma: radical + 'ats' },
                            { etiqueta: 'participi femen√≠ singular', forma: radical + 'ada' },
                            { etiqueta: 'participi femen√≠ plural', forma: radical + 'ades' }
                        ]
                    };
                    break;
                default: 
                    formes = {};
            }
            
            return formes;
        }
        
        function conjugaVerb(verb) {
            let conjugacio, radical;
            
            // Verbs irregulars espec√≠fics
            if (verb === 'estar') {
                conjugacio = 'ar';
                radical = 'est';
            }
            else if (verb === 'ser') {
                conjugacio = 'ar';
                radical = 's';
            }
            else if (verb === 'anar') {
                conjugacio = 'ar';
                radical = 'an';
            }
            // Verbs amb canvis ortogr√†fics
            else if (verb.endsWith('guar')) {
                conjugacio = 'ar';
                radical = verb.slice(0, -4) + 'g√º';
            }
            // Verbs amb canvis ortogr√†fics
            else if (verb.endsWith('quar')) {
                conjugacio = 'ar';
                radical = verb.slice(0, -4) + 'q√º';
            }
            else if (verb.endsWith('car')) {
                conjugacio = 'ar';
                radical = verb.slice(0, -3) + 'cc';
            }
            else if (verb.endsWith('√ßar')) {
                conjugacio = 'ar';
                radical = verb.slice(0, -3) + '√ß√ß';
            }
            else if (verb.endsWith('gar')) {
                conjugacio = 'ar';
                radical = verb.slice(0, -3) + 'gg';
            }
            // Verbs en -iar, -uar, etc.
            else if (verb.endsWith('iar') || verb.endsWith('uar') || verb.endsWith('uar')) {
                conjugacio = 'ar';
                radical = verb.slice(0, -2) + 'y';
            }
            // Tots els altres verbs en -ar
            else if (verb.endsWith('ar')) {
                conjugacio = 'ar';
                radical = verb.slice(0, -2);
            } else {
                return null;
            }
            
            // Conjugaci√≥ regular
            const resultat = {
                present: conjugaPresent(radical, conjugacio),
                imperfet: conjugaImperfet(radical, conjugacio),
		passatSimple: conjugaPassatSimple(radical, conjugacio),
                futur: conjugaFutur(radical, conjugacio),
                condicional: conjugaCondicional(radical, conjugacio),
                subjuntiuPresent: conjugaSubjuntiuPresent(radical, conjugacio),
                imperatiu: conjugaImperatiu(radical, conjugacio),
                formesNominals: conjugaFormesNominals(radical, conjugacio)
            };
            
            // Aplica correccions ortogr√†fiques
            return corregeixOrtografiaResultat(resultat, verb);
        }
        
        // FUNCIONS DE VISUALITZACI√ì
        
        function mostrarResultat(verb, resultat) {
            let html = `
                <div class="result-header">
                    <h2 class="verb-title">${verb}</h2>
                    <span class="conjugation-type">1a Conjugaci√≥ (-ar)</span>
                </div>
            `;
            
            // Present d'indicatiu
            html += `<div class="conjugation-section">
                <h3 class="section-title">Present d'indicatiu</h3>
                <table class="conjugation-table">
                    <tbody>`;
            resultat.present.forEach(item => {
                html += `<tr>
                    <td class="pronoun">${item.etiqueta}</td>
                    <td class="conjugated-form">${item.forma}</td>
                </tr>`;
            });
            html += `</tbody></table></div>`;
            
            // Imperfet d'indicatiu
            html += `<div class="conjugation-section">
                <h3 class="section-title">Imperfet d'indicatiu</h3>
                <table class="conjugation-table">
                    <tbody>`;
            resultat.imperfet.forEach(item => {
                html += `<tr>
                    <td class="pronoun">${item.etiqueta}</td>
                    <td class="conjugated-form">${item.forma}</td>
                </tr>`;
            });
            html += `</tbody></table></div>`;


    // Passat simple 
    html += `<div class="conjugation-section">
        <h3 class="section-title">Passat simple</h3>
        <table class="conjugation-table">
            <tbody>`;
    resultat.passatSimple.forEach(item => {
        html += `<tr>
            <td class="pronoun">${item.etiqueta}</td>
            <td class="conjugated-form">${item.forma}</td>
        </tr>`;
    });
    html += `</tbody></table></div>`;



            
            // Futur
            html += `<div class="conjugation-section">
                <h3 class="section-title">Futur</h3>
                <table class="conjugation-table">
                    <tbody>`;
            resultat.futur.forEach(item => {
                html += `<tr>
                    <td class="pronoun">${item.etiqueta}</td>
                    <td class="conjugated-form">${item.forma}</td>
                </tr>`;
            });
            html += `</tbody></table></div>`;
            
            // Condicional
            html += `<div class="conjugation-section">
                <h3 class="section-title">Condicional</h3>
                <table class="conjugation-table">
                    <tbody>`;
            resultat.condicional.forEach(item => {
                html += `<tr>
                    <td class="pronoun">${item.etiqueta}</td>
                    <td class="conjugated-form">${item.forma}</td>
                </tr>`;
            });
            html += `</tbody></table></div>`;
            
            // Subjuntiu present
            html += `<div class="conjugation-section">
                <h3 class="section-title">Subjuntiu present</h3>
                <table class="conjugation-table">
                    <tbody>`;
            resultat.subjuntiuPresent.forEach(item => {
                html += `<tr>
                    <td class="pronoun">${item.etiqueta}</td>
                    <td class="conjugated-form">${item.forma}</td>
                </tr>`;
            });
            html += `</tbody></table></div>`;
            
            // Imperatiu
            html += `<div class="conjugation-section">
                <h3 class="section-title">Imperatiu</h3>
                <table class="conjugation-table">
                    <tbody>`;
            resultat.imperatiu.forEach(item => {
                html += `<tr>
                    <td class="pronoun">${item.etiqueta}</td>
                    <td class="conjugated-form">${item.forma}</td>
                </tr>`;
            });
            html += `</tbody></table></div>`;
            
            // Formes no personals
            html += `<div class="conjugation-section">
                <h3 class="section-title">Formes no personals</h3>
                <table class="conjugation-table">
                    <tbody>
                        <tr>
                            <td>${resultat.formesNominals.infinitiu.etiqueta}</td>
                            <td>${resultat.formesNominals.infinitiu.forma}</td>
                        </tr>
                        <tr>
                            <td>${resultat.formesNominals.gerundi.etiqueta}</td>
                            <td>${resultat.formesNominals.gerundi.forma}</td>
                        </tr>`;
            resultat.formesNominals.participi.forEach(item => {
                html += `<tr>
                    <td>${item.etiqueta}</td>
                    <td>${item.forma}</td>
                </tr>`;
            });
            html += `</tbody></table></div>`;
            
            conjugationResult.innerHTML = html;
        }
        
        // Gesti√≥ d'errors
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        }
        
        function hideError() {
            errorMessage.style.display = 'none';
        }
        
        // Gesti√≥ de c√†rrega
        function showLoading() {
            loadingIndicator.style.display = 'block';
            conjugationResult.innerHTML = '';
        }
        
        function hideLoading() {
            loadingIndicator.style.display = 'none';
        }
        
        // Neteja l'entrada
        function clearInput() {
            verbInput.value = '';
            conjugationResult.innerHTML = `
                <div class="empty-state">
                    <i>üìù</i>
                    <h3>Introdueix un verb per comen√ßar</h3>
                    <p>Escriu un verb en infinitiu acabat en -ar al camp de l'esquerra</p>
                </div>
            `;
            hideError();
        }
        
        // Gesti√≥ de l'historial
        function addToHistory(verb) {
            conjugationHistory = conjugationHistory.filter(v => v !== verb);
            conjugationHistory.unshift(verb);
            
            if (conjugationHistory.length > 10) {
                conjugationHistory = conjugationHistory.slice(0, 10);
            }
            
            saveHistory();
            updateHistoryUI();
        }
        
        function updateHistoryUI() {
            historyList.innerHTML = '';
            
            conjugationHistory.forEach(verb => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.textContent = verb;
                item.addEventListener('click', () => {
                    verbInput.value = verb;
                    conjugateVerb();
                });
                historyList.appendChild(item);
            });
        }
        
        function saveHistory() {
            localStorage.setItem('conjugationHistory', JSON.stringify(conjugationHistory));
        }
        
        function loadHistory() {
            const saved = localStorage.getItem('conjugationHistory');
            if (saved) {
                conjugationHistory = JSON.parse(saved);
                updateHistoryUI();
            }
        }
    </script>
</body>
</html>
