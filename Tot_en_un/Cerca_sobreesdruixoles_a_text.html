<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extractor de Paraules amb Accent i Vocals</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .description {
            color: #7f8c8d;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .input-section, .results-section {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        h2 {
            color: #3498db;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            font-size: 1.5rem;
        }
        
        textarea {
            width: 100%;
            height: 250px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.3s;
            display: block;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .results-container {
            margin-top: 20px;
        }
        
        .word-list {
            list-style-type: none;
            max-height: 350px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 5px;
            padding: 10px;
        }
        
        .word-item {
            padding: 12px 15px;
            margin-bottom: 8px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #3498db;
            display: flex;
            justify-content: space-between;
        }
        
        .word-text {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .word-details {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f4fc;
            border-radius: 5px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .no-results {
            text-align: center;
            padding: 30px;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .examples {
            background-color: #fff8e1;
            padding: 20px;
            border-radius: 5px;
            margin-top: 30px;
            border-left: 4px solid #f1c40f;
        }
        
        .examples h3 {
            color: #d35400;
            margin-bottom: 10px;
        }
        
        .rules {
            background-color: #e8f6f3;
            padding: 20px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #1abc9c;
        }
        
        .rules h3 {
            color: #16a085;
            margin-bottom: 15px;
        }
        
        .rule-item {
            margin-bottom: 8px;
            padding-left: 10px;
            border-left: 3px solid #1abc9c;
            font-size: 0.95rem;
        }
        
        .highlight {
            background-color: #ffeaa7;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .highlight-accent {
            background-color: #ffcccc;
            padding: 2px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .highlight-vowels {
            background-color: #ccffcc;
            padding: 2px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .highlight-ignored {
            background-color: #ff9999;
            padding: 2px;
            border-radius: 3px;
            text-decoration: line-through;
            font-weight: 600;
        }
        
        .highlight-diaeresis {
            background-color: #ffcc99;
            padding: 2px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .highlight-puntvolat {
            background-color: #ccccff;
            padding: 2px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .highlight-puntuacio {
            background-color: #ffccff;
            padding: 2px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Extractor de Paraules amb Accent i Vocals</h1>
        <p class="description">Aquesta eina analitza un text i extreu les paraules que tenen accents i almenys 3 vocals DESPR√âS de la lletra accentuada, amb TOTES les regles especials del catal√†.</p>
    </header>
    
    <div class="container">
        <section class="input-section">
            <h2>Introdueix el text</h2>
            <textarea id="textInput" placeholder="Escriu o enganxa el text que vols analitzar aqu√≠...">DARRERES REGLES AFEGIDES:

1. l.l (punt baix) igual que l¬∑l: NO para de comptar vocals
   - "col.laboraci√≥" - el punt baix no para el recompte
   
2. q+√º: La '√º' despr√©s de 'q' tampoc compta com a vocal
   - "q√ºesti√≥" - la '√º' s'ignora (igual que 'u' en q+u)
   - "q√ºotidiana" - la '√º' s'ignora
   
3. g+√º: La '√º' despr√©s de 'g' tampoc compta com a vocal
   - "desag√ºe" - la '√º' s'ignora
   - "aig√ºes" - la '√º' s'ignora
   - "ping√º√≠" - la '√º' s'ignora

EXEMPLES COMPLETS:

AMB ACCENT I 3+ VOCALS:
- "espont√†niament" - accent '√†', despr√©s: i, a, e (3 vocals)
- "r√†pidament" - accent '√†', despr√©s: i, a, e (3 vocals)

SENSE POU VOCALS:
- "q√ºesti√≥" - accent '√≥' (final), '√º' ignorada (0 vocals)
- "ping√º√≠" - accent '√≠' (final), '√º' ignorada (0 vocals)
- "desag√ºe" - no t√© accent v√†lid (√º no compta)
- "aig√ºes" - no t√© accent v√†lid
- "col¬∑laboraci√≥" - accent '√≥' (final), punt volat no para (0 vocals)
- "col.laboraci√≥" - accent '√≥' (final), punt baix no para (0 vocals)

CASOS L√çMIT:
- "lleng√ºes" - '√º' no accent, no hi ha altre accent
- "antig√ºitat" - '√º' no accent, accent '√≠' i despr√©s 't', 'a', 't' ‚Üí 'a' (1 vocal)
- "q√ºotidiana" - '√º' ignorada, accent '√≠' i despr√©s 'a', 'n', 'a' ‚Üí 'a', 'a' (2 vocals)
- "exq√ºisit" - '√º' ignorada, accent '√≠' i despr√©s 's', 'i', 't' ‚Üí 'i' (1 vocal)

PROVA AMB:
"Espont√†niament √©s una paraula q√ºotidiana que apareix r√†pidament en textos col¬∑laboratius i col.laboratius. El desag√ºe de les aig√ºes √©s un tema ping√º√≠."</textarea>
            <button id="analyzeButton">Analitza el text</button>
            
            <div class="rules">
                <h3>üìã TOTES les regles de cerca</h3>
                <div class="rule-item"><strong>1. ACCENTS V√ÄLIDS:</strong> √†, √®, √©, √≠, √≥, √≤, √∫</div>
                <div class="rule-item"><strong>2. DI√àRESIS NO ACCENT:</strong> √Ø, √º NO compta com a accents</div>
                <div class="rule-item"><strong>3. Q+U/UÃà:</strong> 'u' o '√º' despr√©s de 'q' NO compta com a vocal</div>
                <div class="rule-item"><strong>4. G+U/UÃà:</strong> 'u' o '√º' despr√©s de 'g' NO compta com a vocal</div>
                <div class="rule-item"><strong>5. PUNTUACI√ì PARA:</strong> Signes (.,;:'"¬ø?¬°!()[]{}/-) paren recompte</div>
                <div class="rule-item"><strong>6. EXCEPCI√ì PUNT VOLAT/BAIX:</strong> l¬∑l i l.l NO paren recompte</div>
                <div class="rule-item"><strong>7. REQUISIT FINAL:</strong> ‚â•3 vocals v√†lides despr√©s del primer accent</div>
            </div>
            
            <div class="examples">
                <h3>Exemples d'aplicaci√≥ de totes les regles:</h3>
                <p><span class="highlight">q√ºesti√≥</span> ‚Üí <span class="highlight-ignored">√º</span> ignorada (q+√º), accent <span class="highlight-accent">√≥</span> final</p>
                <p><span class="highlight">ping√º√≠</span> ‚Üí <span class="highlight-ignored">√º</span> ignorada (g+√º), accent <span class="highlight-accent">√≠</span> final</p>
                <p><span class="highlight">col¬∑laboraci√≥</span> ‚Üí punt volat <span class="highlight-puntvolat">¬∑</span> no para, accent <span class="highlight-accent">√≥</span> final</p>
                <p><span class="highlight">col.laboraci√≥</span> ‚Üí punt baix <span class="highlight-puntvolat">.</span> no para, accent <span class="highlight-accent">√≥</span> final</p>
                <p><span class="highlight">desag√ºe</span> ‚Üí <span class="highlight-ignored">√º</span> ignorada (g+√º), no hi ha accent v√†lid</p>
            </div>
        </section>
        
        <section class="results-section">
            <h2>Paraules trobades</h2>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalWords">0</div>
                    <div class="stat-label">Paraules analitzades</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="foundWords">0</div>
                    <div class="stat-label">Paraules trobades</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="withAccents">0</div>
                    <div class="stat-label">Amb accents</div>
                </div>
            </div>
            
            <div class="results-container">
                <ul id="wordList" class="word-list">
                    <li class="no-results">Encara no s'ha analitzat cap text. Fes clic a "Analitza el text" per comen√ßar.</li>
                </ul>
            </div>
        </section>
    </div>
    
    <footer>
        <p>Eina desenvolupada per a l'an√†lisi de text en catal√† | TOTES les regles especials aplicades</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const textInput = document.getElementById('textInput');
            const analyzeButton = document.getElementById('analyzeButton');
            const wordList = document.getElementById('wordList');
            const totalWordsElement = document.getElementById('totalWords');
            const foundWordsElement = document.getElementById('foundWords');
            const withAccentsElement = document.getElementById('withAccents');
            
            // Vocals en catal√† (incloent accentuades)
            const vocals = new Set(['a', 'e', 'i', 'o', 'u', '√†', '√®', '√©', '√≠', '√Ø', '√≥', '√≤', '√∫', '√º']);
            
            // Lletres accentuades (EXCLOENT di√®resis)
            const lletresAmbAccent = new Set(['√†', '√®', '√©', '√≠', '√≥', '√≤', '√∫']);
            
            // Signes de puntuaci√≥ que paren el recompte
            const signesPuntuacio = new Set([',', ';', ':', "'", '"', '¬ø', '?', '¬°', '!', '(', ')', '[', ']', '{', '}', '/', '\\', '-']);
            
            // Funci√≥ per comprovar si √©s punt volat/baix entre dues 'l' (l¬∑l o l.l)
            function esPuntVolatOCompost(text, index) {
                const char = text[index];
                
                // Comprovar si √©s punt volat (¬∑) o punt baix (.) entre l i l
                if (char === '¬∑' || char === '.' || char === '‚Ä¢') {
                    // Comprovar si hi ha 'l' abans i despr√©s
                    const abans = index > 0 ? text[index-1].toLowerCase() : '';
                    const despres = index < text.length - 1 ? text[index+1].toLowerCase() : '';
                    
                    // Comprovar si √©s l.l o l¬∑l (l seguit de punt/punt volat seguit de l)
                    return (abans === 'l' && despres === 'l');
                }
                
                return false;
            }
            
            // Funci√≥ per comprovar si √©s 'u' o '√º' que s'ha d'ignorar (regles Q+U/√ú i G+U/√ú)
            function esUO√úIgnorada(text, index) {
                const char = text[index].toLowerCase();
                
                // Nom√©s processem 'u' i '√º'
                if (char !== 'u' && char !== '√º') return false;
                
                // Regla Q+U/√ú
                if (index > 0 && text[index-1].toLowerCase() === 'q') {
                    return true;
                }
                
                // Regla G+U/√ú - 'u' o '√º' despr√©s de 'g'
                if (index > 0 && text[index-1].toLowerCase() === 'g') {
                    // 'u' o '√º' despr√©s de 'g' sempre s'ignora
                    return true;
                }
                
                return false;
            }
            
            // Funci√≥ per netejar i preparar el text
            function netejarParaula(paraula) {
                // Eliminar signes de puntuaci√≥ nom√©s al principi i final
                return paraula.replace(/^[^a-zA-Z√†√®√©√≠√Ø√≥√≤√∫√º√Ä√à√â√ç√è√ì√í√ö√ú¬∑‚Ä¢]+|[^a-zA-Z√†√®√©√≠√Ø√≥√≤√∫√º√Ä√à√â√ç√è√ì√í√ö√ú¬∑‚Ä¢]+$/g, '');
            }
            
            // Funci√≥ per comprovar si una paraula t√© accents (EXCLOENT di√®resis)
            function teAccent(paraula) {
                for (let i = 0; i < paraula.length; i++) {
                    const lletra = paraula[i].toLowerCase();
                    if (lletresAmbAccent.has(lletra)) {
                        return true;
                    }
                }
                return false;
            }
            
            // Funci√≥ per comprovar si una paraula t√© vocals i consonants
            function teVocalsIConsonants(paraula) {
                const paraulaMin = paraula.toLowerCase();
                let teVocal = false;
                let teConsonant = false;
                
                for (let i = 0; i < paraulaMin.length; i++) {
                    const lletra = paraulaMin[i];
                    
                    // Saltar punt volat/baix entre l¬∑l o l.l
                    if (esPuntVolatOCompost(paraulaMin, i)) continue;
                    
                    // Saltar signes de puntuaci√≥
                    if (signesPuntuacio.has(lletra)) continue;
                    
                    // Comprovar si √©s vocal (tenint en compte regles Q+U/√ú i G+U/√ú)
                    let esVocal = vocals.has(lletra) && !esUO√úIgnorada(paraulaMin, i);
                    
                    if (esVocal) {
                        teVocal = true;
                    } else if (lletra >= 'a' && lletra <= 'z') {
                        teConsonant = true;
                    }
                    
                    if (teVocal && teConsonant) {
                        return true;
                    }
                }
                
                return false;
            }
            
            // Funci√≥ per comprovar si hi ha almenys 3 vocals DESPR√âS de l'accent (amb TOTES les regles)
            function teTresVocalsDespresAccent(paraula) {
                const paraulaMin = paraula.toLowerCase();
                let posicioAccent = -1;
                
                // Trobar la posici√≥ de la primera lletra accentuada (EXCLOENT di√®resis)
                for (let i = 0; i < paraulaMin.length; i++) {
                    const lletra = paraulaMin[i];
                    if (lletresAmbAccent.has(lletra)) {
                        posicioAccent = i;
                        break;
                    }
                }
                
                // Si no hi ha accent (excloent di√®resis), retorna false
                if (posicioAccent === -1) return false;
                
                // Comptar vocals DESPR√âS de la posici√≥ de l'accent (amb TOTES les regles)
                let comptadorVocals = 0;
                for (let i = posicioAccent + 1; i < paraulaMin.length; i++) {
                    const lletra = paraulaMin[i];
                    
                    // Comprovar si √©s punt volat/baix entre l¬∑l o l.l (NO para)
                    if (esPuntVolatOCompost(paraulaMin, i)) {
                        continue;
                    }
                    
                    // Comprovar si √©s signe de puntuaci√≥ (PARA el recompte)
                    if (signesPuntuacio.has(lletra)) {
                        break;
                    }
                    
                    // Comprovar si √©s vocal (tenint en compte regles Q+U/√ú i G+U/√ú)
                    let esVocal = vocals.has(lletra) && !esUO√úIgnorada(paraulaMin, i);
                    
                    if (esVocal) {
                        comptadorVocals++;
                        if (comptadorVocals >= 3) {
                            return true;
                        }
                    }
                }
                
                return false;
            }
            
            // Funci√≥ auxiliar per destacar tots els elements especials
            function destacarParaula(paraula) {
                const paraulaMin = paraula.toLowerCase();
                let resultat = '';
                let posicioAccent = -1;
                
                // Trobar la posici√≥ de l'accent (excloent di√®resis)
                for (let i = 0; i < paraulaMin.length; i++) {
                    const lletra = paraulaMin[i];
                    if (lletresAmbAccent.has(lletra)) {
                        posicioAccent = i;
                        break;
                    }
                }
                
                // Construir el resultat amb tots els elements destacats
                for (let i = 0; i < paraula.length; i++) {
                    const lletra = paraula[i];
                    const lletraMin = paraulaMin[i];
                    
                    // Determinar tipus d'element
                    const esPuntCompost = esPuntVolatOCompost(paraulaMin, i);
                    const esUIgnorada = esUO√úIgnorada(paraulaMin, i);
                    const esDiaeresis = (lletraMin === '√Ø' || lletraMin === '√º');
                    const esAccent = (i === posicioAccent);
                    const esPuntuacio = signesPuntuacio.has(lletraMin) && !esPuntCompost;
                    const esVocalValidaDespres = (i > posicioAccent && vocals.has(lletraMin) && !esUIgnorada && !esPuntuacio && !esPuntCompost);
                    
                    if (esPuntCompost) {
                        resultat += `<span class="highlight-puntvolat">${lletra}</span>`;
                    } else if (esAccent) {
                        resultat += `<span class="highlight-accent">${lletra}</span>`;
                    } else if (esDiaeresis && !esUIgnorada) {
                        resultat += `<span class="highlight-diaeresis">${lletra}</span>`;
                    } else if (esUIgnorada) {
                        resultat += `<span class="highlight-ignored">${lletra}</span>`;
                    } else if (esPuntuacio) {
                        resultat += `<span class="highlight-puntuacio">${lletra}</span>`;
                    } else if (esVocalValidaDespres) {
                        resultat += `<span class="highlight-vowels">${lletra}</span>`;
                    } else {
                        resultat += lletra;
                    }
                }
                
                return resultat;
            }
            
            // Funci√≥ auxiliar per trobar totes les vocals v√†lides despr√©s de l'accent (amb totes les regles)
            function trobarVocalsDespresAccent(paraula) {
                const paraulaMin = paraula.toLowerCase();
                let posicioAccent = -1;
                
                // Trobar la posici√≥ de l'accent (excloent di√®resis)
                for (let i = 0; i < paraulaMin.length; i++) {
                    const lletra = paraulaMin[i];
                    if (lletresAmbAccent.has(lletra)) {
                        posicioAccent = i;
                        break;
                    }
                }
                
                if (posicioAccent === -1) return '';
                
                // Trobar totes les vocals v√†lides despr√©s de l'accent (amb TOTES les regles)
                let vocalsTrobades = '';
                
                for (let i = posicioAccent + 1; i < paraulaMin.length; i++) {
                    const lletra = paraulaMin[i];
                    
                    // Comprovar si √©s punt volat/baix entre l¬∑l o l.l (NO para)
                    if (esPuntVolatOCompost(paraulaMin, i)) {
                        continue;
                    }
                    
                    // Comprovar si √©s signe de puntuaci√≥ (PARA el recompte)
                    if (signesPuntuacio.has(lletra)) {
                        break;
                    }
                    
                    // Comprovar si √©s vocal v√†lida (tenint en compte TOTES les regles)
                    const esVocal = vocals.has(lletra) && !esUO√úIgnorada(paraulaMin, i);
                    
                    if (esVocal) {
                        vocalsTrobades += lletra;
                    }
                }
                
                return vocalsTrobades;
            }
            
            // Funci√≥ principal per analitzar el text
            function analitzarText() {
                const text = textInput.value;
                // Separar per espais, salts de l√≠nia i alguns signes de puntuaci√≥
                const paraules = text.split(/[\s\n\r]+/);
                const paraulesValides = [];
                let totalParaules = 0;
                let paraulesAmbAccent = 0;
                
                // Netejar la llista de resultats
                wordList.innerHTML = '';
                
                // Analitzar cada paraula
                for (let paraula of paraules) {
                    const paraulaNeta = netejarParaula(paraula);
                    
                    // Ignorar paraules buides
                    if (paraulaNeta.length === 0) continue;
                    
                    totalParaules++;
                    
                    // Comprovar si t√© accents (excloent di√®resis)
                    const accent = teAccent(paraulaNeta);
                    if (accent) paraulesAmbAccent++;
                    
                    // Comprovar els criteris (AMB TOTES LES REGLES)
                    if (accent && 
                        teVocalsIConsonants(paraulaNeta) && 
                        teTresVocalsDespresAccent(paraulaNeta)) {
                        
                        paraulesValides.push({
                            text: paraulaNeta,
                            accent: accent,
                            vocalsDespres: trobarVocalsDespresAccent(paraulaNeta)
                        });
                    }
                }
                
                // Actualitzar estad√≠stiques
                totalWordsElement.textContent = totalParaules;
                foundWordsElement.textContent = paraulesValides.length;
                withAccentsElement.textContent = paraulesAmbAccent;
                
                // Mostrar resultats
                if (paraulesValides.length === 0) {
                    const noResults = document.createElement('li');
                    noResults.className = 'no-results';
                    noResults.textContent = 'No s\'han trobat paraules que compleixin tots els criteris.';
                    wordList.appendChild(noResults);
                } else {
                    paraulesValides.forEach(paraula => {
                        const listItem = document.createElement('li');
                        listItem.className = 'word-item';
                        
                        listItem.innerHTML = `
                            <div>
                                <span class="word-text">${destacarParaula(paraula.text)}</span>
                                <div class="word-details">Vocals v√†lides despr√©s de l'accent: "${paraula.vocalsDespres}" (${paraula.vocalsDespres.length} vocals)</div>
                            </div>
                            <div class="word-details">${paraula.text.length} car√†cters</div>
                        `;
                        
                        wordList.appendChild(listItem);
                    });
                }
            }
            
            // Afegir event listener al bot√≥
            analyzeButton.addEventListener('click', analitzarText);
            
            // Analitzar autom√†ticament el text d'exemple al carregar la p√†gina
            setTimeout(() => {
                analyzeButton.click();
            }, 500);
        });
    </script>
</body>
</html>
