<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8" />
<title>Relaciona: Jocs en polon√®s</title>
<style>
body {
  font-family: 'Georgia', serif;
  max-width: 900px;
  margin: auto;
  padding: 20px;
  background: #fff;
  color: #000;
}
h1 {
  color: #003366;
}
#tema-selector {
  margin-bottom: 20px;
}
#tema-selector select {
  padding: 6px;
  font-size: 14px;
}
.match-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2em;
  padding: 20px 0;
  min-height: 400px;
  position: relative;
}
.match-lines {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}
.col {
  display: flex;
  flex-direction: column;
}
.item {
  padding: 10px;
  border: 1px solid #ccc;
  margin-bottom: 6px;
  cursor: pointer;
  user-select: none;
  transition: background-color 0.2s ease, border 0.2s ease;
  background-color: #fff;
}
.selected {
  background-color: #d0ebff;
}
.matched {
  border: 2px solid green;
  background-color: #e8fbe8;
}
.fixed-pol {
  border: 2px solid orange;
  background-color: #fffacc !important;
}
.fixed-cat {
  border: 2px solid orange;
  background-color: #fffacc !important;
  pointer-events: none; /* Traduccions no clicables un cop resoltes */
}
.incorrect-pol, .incorrect-cat {
  border: 2px solid red;
  background-color: #ffeaea !important;
}
#score {
  font-weight: bold;
  margin-top: 1em;
  color: #003366;
}
#controls {
  margin-top: 2em;
}
#controls button {
  margin: 5px 5px 15px 0;
  padding: 6px 12px;
  font-size: 14px;
  background-color: #003366;
  color: #fff;
  border: none;
  cursor: pointer;
}
#controls button:hover {
  background-color: #005599;
}
.nota {
  margin-top: 30px;
  padding: 12px;
  background: #f4f8ff;
  border-left: 4px solid #003366;
  font-size: 14px;
}
</style>
</head>
<body>

<h1>Relaciona en polon√®s</h1>
<div id="tema-selector">
  <label for="tema">Tria un tema: </label>
  <select id="tema">
    <option value="colors">Colors</option>
    <option value="fruites">Fruites</option>
    <option value="fruites_poloneses">Fruites</option>
    <option value="numeros">N√∫meros (1-10)</option>
    <option value="cortesia">Frases de cortesia</option>
    <option value="transport">Transport</option>
    <option value="barca">Barca</option>
    <option value="menjar">Menjar</option>
    <option value="dies">Dies</option>
    <option value="possessius">Possessius</option> <!-- Afegit -->
    <option value="apats">√Äpats i serveis</option>
    <option value="bistro_dolc">Esmorzar dol√ß - Gdansk</option>
    <option value="bistro_salat">Esmorzar salat - Gdansk</option>
  </select>
  <button onclick="canviaTema()">‚úÖ Carrega tema</button>
</div>

<div class="match-container">
  <svg class="match-lines"></svg>
  <div class="col" id="polones"></div>
  <div class="col" id="catala"></div>
</div>

<div id="score">Encerts: 0 / 10</div>
<div id="controls">
  <button onclick="novaRonda()">üîÅ Torna a comen√ßar</button>
</div>

<div class="nota">
  Verd = encert a la primera | Groc = encert despr√©s d'errors (es repetir√† a la seg√ºent ronda) | Vermell = error.
</div>

<script>
const TOTAL_PER_RONDA = 10;

const TEMES = {
  colors: [
    {"id":1,"pol":"bia≈Çy","cat":"blanc"},
    {"id":2,"pol":"czarny","cat":"negre"},
    {"id":3,"pol":"czerwony","cat":"vermell"},
    {"id":4,"pol":"niebieski","cat":"blau"},
    {"id":5,"pol":"zielony","cat":"verd"},
    {"id":6,"pol":"≈º√≥≈Çty","cat":"groc"},
    {"id":7,"pol":"pomara≈Ñczowy","cat":"taronja"},
    {"id":8,"pol":"r√≥≈ºowy","cat":"rosa"},
    {"id":9,"pol":"fioletowy","cat":"lila"},
    {"id":10,"pol":"brƒÖzowy","cat":"marr√≥"},
    {"id":11,"pol":"szary","cat":"gris"},
    {"id":12,"pol":"be≈ºowy","cat":"beix"}
  ],
  fruites: [
    {"id":1,"pol":"jab≈Çko","cat":"poma"},
    {"id":2,"pol":"gruszka","cat":"pera"},
    {"id":3,"pol":"banan","cat":"pl√†tan"},
    {"id":4,"pol":"pomara≈Ñcza","cat":"taronja"},
    {"id":5,"pol":"cytryna","cat":"llimona"},
    {"id":6,"pol":"winogrono","cat":"ra√Øm"},
    {"id":7,"pol":"truskawka","cat":"maduixa"},
    {"id":8,"pol":"wi≈õnia","cat":"cirera"},
    {"id":9,"pol":"malina","cat":"gerd"},
    {"id":10,"pol":"arbuz","cat":"s√≠ndria"},
    {"id":11,"pol":"ananas","cat":"pinya"},
    {"id":12,"pol":"brzoskwinia","cat":"pr√©ssec"}
  ],
fruites_poloneses: [
    {"id":1,"pol":"jab≈Çko","cat":"poma"},
    {"id":2,"pol":"gruszka","cat":"pera"},
    {"id":3,"pol":"≈õliwka","cat":"pruna"},
    {"id":4,"pol":"czarna porzeczka","cat":"grosella negra"},
    {"id":5,"pol":"czerwona porzeczka","cat":"grosella vermella"},
    {"id":6,"pol":"bor√≥wka","cat":"nabiu"},
    {"id":7,"pol":"truskawka","cat":"maduixa"},
    {"id":8,"pol":"poziomka","cat":"maduixa de bosc"},
    {"id":9,"pol":"malina","cat":"gerd"},
    {"id":10,"pol":"je≈ºyna","cat":"m√≥ra"}
],
  numeros: [
    {"id":1,"pol":"jeden","cat":"1"},
    {"id":2,"pol":"dwa","cat":"2"},
    {"id":3,"pol":"trzy","cat":"3"},
    {"id":4,"pol":"cztery","cat":"4"},
    {"id":5,"pol":"piƒôƒá","cat":"5"},
    {"id":6,"pol":"sze≈õƒá","cat":"6"},
    {"id":7,"pol":"siedem","cat":"7"},
    {"id":8,"pol":"osiem","cat":"8"},
    {"id":9,"pol":"dziewiƒôƒá","cat":"9"},
    {"id":10,"pol":"dziesiƒôƒá","cat":"10"}
  ],
cortesia: [
    {"id":1,"pol":"tak","cat":"s√≠"},
    {"id":2,"pol":"nie","cat":"no"},
    {"id":3,"pol":"dziƒôkujƒô","cat":"gr√†cies"},
    {"id":4,"pol":"proszƒô","cat":"si us plau"},
    {"id":5,"pol":"przepraszam","cat":"perd√≥"},
    {"id":6,"pol":"dzie≈Ñ dobry","cat":"bon dia (fins a migdia)"},
    {"id":7,"pol":"dobry wiecz√≥r","cat":"bona tarda / bon vespre (a partir de les 16-17 h)"},
    {"id":8,"pol":"dobranoc","cat":"bona nit (quan ens acomiadem per anar a dormir)"},
    {"id":9,"pol":"cze≈õƒá","cat":"hola (informal)"},
    {"id":10,"pol":"do widzenia","cat":"ad√©u (formal)"},
    {"id":11,"pol":"pa","cat":"ad√©u (informal, com ‚Äòadeu-siau‚Äô)"}
],

  transport: [
  {"id":1,"pol":"Lotnisko","cat":"Aeroport"},
  {"id":2,"pol":"Samolot","cat":"Avi√≥"},
  {"id":3,"pol":"Walizka","cat":"Maleta"},
  {"id":4,"pol":"Autostrada","cat":"Autopista"},
  {"id":5,"pol":"Stacja benzynowa","cat":"Gasolinera"},
  {"id":6,"pol":"Parking","cat":"Aparcament"},
  {"id":7,"pol":"P≈Çatna droga","cat":"Peatge"},
  {"id":8,"pol":"Wypadek","cat":"Accident"},
  {"id":9,"pol":"Pas bezpiecze≈Ñstwa","cat":"Cintur√≥ de seguretat"},
  {"id":10,"pol":"Samoch√≥d","cat":"Cotxe"}
  ],
  barca: [
  {"id":1,"pol":"≈Å√≥d≈∫","cat":"Barca"},
  {"id":2,"pol":"Rzeka","cat":"Riu"},
  {"id":3,"pol":"Jezioro","cat":"Lac"},
  {"id":4,"pol":"Kotwica","cat":"√Äncora"},
  {"id":5,"pol":"Kamizelka ratunkowa","cat":"Armilla salvavides"},
  {"id":6,"pol":"Mapa","cat":"Mapa"},
  {"id":7,"pol":"Przysta≈Ñ","cat":"Port"},
  {"id":8,"pol":"Silnik","cat":"Motor"},
  {"id":9,"pol":"Benzyna","cat":"Gasolina"},
  {"id":10,"pol":"P≈ÇynƒÖƒá","cat":"Navegar"}
  ],
  menjar: [
  {"id":1,"pol":"Woda","cat":"Aigua"},
  {"id":2,"pol":"Chleb","cat":"Pa"},
  {"id":3,"pol":"Piwo","cat":"Cervesa"},
  {"id":4,"pol":"Wino","cat":"Vi"},
  {"id":5,"pol":"≈öniadanie","cat":"Esmorzar"},
  {"id":6,"pol":"Obiad","cat":"Dinar"},
  {"id":7,"pol":"Kolacja","cat":"Sopar"},
  {"id":8,"pol":"Ryba","cat":"Peix"},
  {"id":9,"pol":"Miƒôso","cat":"Carn"},
  {"id":10,"pol":"Sa≈Çatka","cat":"Amanida"},
  {"id":11,"pol":"Deser","cat":"Postres"},
  {"id":12,"pol":"Kawa","cat":"Caf√®"},
  {"id":13,"pol":"Herbata","cat":"Te"}
],
dies: [
  {"id":1,"pol":"Poniedzia≈Çek","cat":"Dilluns"},
  {"id":2,"pol":"Wtorek","cat":"Dimarts"},
  {"id":3,"pol":"≈öroda","cat":"Dimecres"},
  {"id":4,"pol":"Czwartek","cat":"Dijous"},
  {"id":5,"pol":"PiƒÖtek","cat":"Divendres"},
  {"id":6,"pol":"Sobota","cat":"Dissabte"},
  {"id":7,"pol":"Niedziela","cat":"Diumenge"},
  {"id":8,"pol":"Dzi≈õ","cat":"Avui"},
  {"id":9,"pol":"Jutro","cat":"Dem√†"},
  {"id":10,"pol":"Wczoraj","cat":"Ahir"},
  {"id":11,"pol":"Rano","cat":"Mat√≠"},
  {"id":12,"pol":"Wiecz√≥r","cat":"Vespre"},
  {"id":13,"pol":"Noc","cat":"Nit"}
],
  possessius: [
    {"id":1,"pol":"m√≥j","cat":"el meu"},
    {"id":2,"pol":"moja","cat":"la meva"},
    {"id":3,"pol":"moje","cat":"el meu (neutre)"},
    {"id":4,"pol":"tw√≥j","cat":"el teu"},
    {"id":5,"pol":"twoja","cat":"la teva"},
    {"id":6,"pol":"twoje","cat":"el teu (neutre)"},
    {"id":7,"pol":"jego","cat":"el seu (d‚Äôell)"},
    {"id":8,"pol":"jej","cat":"el seu (d‚Äôella)"},
    {"id":9,"pol":"nasz","cat":"el nostre"},
    {"id":10,"pol":"nasza","cat":"la nostra"},
    {"id":11,"pol":"wasz","cat":"el vostre"},
    {"id":12,"pol":"wasza","cat":"la vostra"},
    {"id":13,"pol":"ich","cat":"el seu (d‚Äôells/d‚Äôelles)"}
],
apats: [
    {"id":1,"pol":"≈õniadanie","cat":"esmorzar"},
    {"id":2,"pol":"obiad","cat":"dinar"},
    {"id":3,"pol":"kolacja","cat":"sopar"},
    {"id":4,"pol":"bufet","cat":"bufet lliure"},
    {"id":5,"pol":"rezerwacja wymagana","cat":"cal reserva"},
    {"id":6,"pol":"otwarte","cat":"obert"},
    {"id":7,"pol":"zamkniƒôte","cat":"tancat"},
    {"id":8,"pol":"toaleta","cat":"lavabo"},
    {"id":9,"pol":"mƒô≈ºczy≈∫ni","cat":"homes"},
    {"id":10,"pol":"kobiety","cat":"dones"},
    {"id":11,"pol":"restauracja","cat":"restaurant"},
    {"id":12,"pol":"samoobs≈Çuga","cat":"self-service"},
    {"id":13,"pol":"rezerwowany stolik","cat":"taula reservada"},
    {"id":14,"pol":"wej≈õcie","cat":"entrada"},
    {"id":15,"pol":"wyj≈õcie","cat":"sortida"},
    {"id":16,"pol":"menu","cat":"men√∫"},
    {"id":17,"pol":"rachunek","cat":"compte (factura)"},
    {"id":18,"pol":"kelner","cat":"cambrer"},
    {"id":19,"pol":"napoje","cat":"begudes"},
    {"id":20,"pol":"przystawka","cat":"entrant"},
    {"id":21,"pol":"drugie danie","cat":"segon plat"},
    {"id":22,"pol":"deser","cat":"postres"},
    {"id":22,"pol":"owoc","cat":"fruita"},
    {"id":23,"pol":"sezonowe","cat":"de temporada"},
    {"id":24,"pol":"wiejska","cat":"de pag√®s"},
    {"id":25,"pol":"wƒôdzonej","cat":"fumat"},
    {"id":26,"pol":"sos","cat":"salsa"},
    {"id":27,"pol":"domowa","cat":"casolana"},
    {"id":28,"pol":"bezglutenowe","cat":"sense gluten"},
    {"id":29,"pol":"piklowana","cat":"adobat"},
    {"id":30,"pol":"olej","cat":"oli"},
    {"id":31,"pol":"ocet","cat":"vinagre"},
    {"id":32,"pol":"s√≥l","cat":"sal"},
    {"id":33,"pol":"wieprzowina","cat":"porc"},
    {"id":34,"pol":"wo≈Çowego","cat":"vedella"},
    {"id":35,"pol":"kurczak","cat":"pollastre"}
  
],
bistro_dolc: [
    {"id":1,"pol":"croissant","cat":"croissant"},
    {"id":2,"pol":"brioszka","cat":"brioix"},
    {"id":3,"pol":"konfitura","cat":"confitura"},
    {"id":4,"pol":"mi√≥d","cat":"mel"},
    {"id":5,"pol":"mas≈Ço","cat":"mantega"},
    {"id":6,"pol":"pomara≈Ñcza brul√©e","cat":"taronja cremada"},
    {"id":7,"pol":"d≈ºem","cat":"melmelada"},
    {"id":8,"pol":"owoce","cat":"fruites"},
    {"id":9,"pol":"orzechy w≈Çoskie","cat":"nous"},
    {"id":10,"pol":"orzechy arachidowe","cat":"cacauets"},
    {"id":11,"pol":"syrop klonowy","cat":"xarop d‚Äôaur√≥"},
    {"id":12,"pol":"s≈Çony karmel","cat":"caramel salat"},
    {"id":13,"pol":"cukier","cat":"sucre"},
    {"id":14,"pol":"p≈Çatki","cat":"cereals d'esmorzar"},
    {"id":15,"pol":"owsiane","cat":"civada"},
    {"id":16,"pol":"jogurt","cat":"iogurt"},
    {"id":17,"pol":"bakalie","cat":"fruita seca i deshidratada"},
    {"id":18,"pol":"kremowy serek","cat":"formatge crem√≥s (dol√ß o amb vainilla)"},
    {"id":19,"pol":"mleko","cat":"llet"}
],

bistro_salat: [
    {"id":1,"pol":"jajecznica","cat":"ous remenats"},
    {"id":2,"pol":"jaja sadzone","cat":"ous ferrats"},
    {"id":3,"pol":"frankfurterki","cat":"salsitxes tipus Frankfurt"},
    {"id":4,"pol":"szynka","cat":"pernil"},
    {"id":5,"pol":"twar√≥g","cat":"mat√≥ / formatge fresc"},
    {"id":6,"pol":"ser","cat":"formatge"},
    {"id":7,"pol":"czosnkiem","cat":"all"},
    {"id":8,"pol":"sk√≥rkƒÖ cytrynowƒÖ","cat":"pell de llimona"},
    {"id":9,"pol":"sa≈Çatka","cat":"amanida"},
    {"id":10,"pol":"og√≥rk√≥w","cat":"cogombre"},
    {"id":11,"pol":"koperkiem","cat":"anet"},
    {"id":12,"pol":"warzywa","cat":"verdures"},
    {"id":13,"pol":"oliwa","cat":"oli"},
    {"id":14,"pol":"papryki","cat":"pebrot"},
    {"id":15,"pol":"focaccia","cat":"coca de pa"},
    {"id":16,"pol":"pieczywo","cat":"pa (assortit)"},
    {"id":17,"pol":"kaszanka","cat":"botifarra negra"},
    {"id":18,"pol":"fasola","cat":"mongetes"},
    {"id":19,"pol":"boczek wƒôdzony","cat":"cansalada"},
    {"id":20,"pol":"hash browns","cat":"truita de patata (hamburguesa)"},
    {"id":21,"pol":"pomidor","cat":"tom√†quet"},
    {"id":22,"pol":"pastrami","cat":"llom (embotit)"},
    {"id":23,"pol":"przepi√≥rcze jaja","cat":"ous de guatlla"},
    {"id":24,"pol":"awokado","cat":"alvocat"},
    {"id":25,"pol":"cebula","cat":"ceba"},
    {"id":26,"pol":"pikantny majonez","cat":"maionesa picant"},
    {"id":27,"pol":"oliwki","cat":"olives"},
    {"id":28,"pol":"suszone pomidory","cat":"tom√†quets secs"},
    {"id":29,"pol":"zio≈Ça","cat":"herbes"},
    {"id":30,"pol":"szpinak","cat":"espinacs"},
    {"id":31,"pol":"pieczarkami","cat":"xampinyons"},
    {"id":32,"pol":"rukola","cat":"r√∫cula"},
    {"id":33,"pol":"sos","cat":"salsa"},
    {"id":34,"pol":"sa≈Çata","cat":"enciam"},
    {"id":35,"pol":"szczypiorek","cat":"cibulet"},
    {"id":36,"pol":"pra≈ºona cebula","cat":"ceba fregida cruixent"}
]



};

let frasesActuals = TEMES.colors;
let encerts = 0;
let selectedPol = null;
let currentAttempts = {};

function canviaTema() {
  frasesActuals = TEMES[document.getElementById("tema").value];
  novaRonda();
}

function barreja(array) {
  return array.slice().sort(() => Math.random() - 0.5);
}

function speakPolish(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = "pl-PL";
  speechSynthesis.cancel();
  speechSynthesis.speak(utterance);
}

function actualitzaPuntuacio() {
  document.getElementById("score").textContent = `Encerts: ${encerts} / ${TOTAL_PER_RONDA}`;
}

function novaRonda() {
  const grogues = [];
  document.querySelectorAll(".fixed-pol").forEach(el => {
    grogues.push(parseInt(el.dataset.id));
  });

  const restants = frasesActuals.filter(f => !grogues.includes(f.id));
  const seleccionades = [];

  grogues.forEach(id => {
    const paraula = frasesActuals.find(f => f.id === id);
    if (paraula) seleccionades.push(paraula);
  });

  const addicionals = barreja(restants).slice(0, TOTAL_PER_RONDA - seleccionades.length);
  seleccionades.push(...addicionals);

  currentAttempts = {};
  generaExercici(seleccionades);
  dibuixaLinies();
}

function netejaErrors() {
  document.querySelectorAll(".incorrect-pol, .incorrect-cat").forEach(el => {
    el.classList.remove("incorrect-pol", "incorrect-cat");
  });
}

function mouAlTop(element) {
  const parent = element.parentNode;
  parent.insertBefore(element, parent.firstChild);
}

function dibuixaLinies() {
  const svg = document.querySelector(".match-lines");
  svg.innerHTML = "";
  const polContainer = document.getElementById("polones");
  const catContainer = document.getElementById("catala");

  const matchedPol = polContainer.querySelectorAll(".matched, .fixed-pol");
  matchedPol.forEach(pol => {
    const polId = pol.dataset.id;
    const cat = catContainer.querySelector(`.matched[data-id="${polId}"], .fixed-cat[data-id="${polId}"]`);
    if (cat) {
      const polRect = pol.getBoundingClientRect();
      const catRect = cat.getBoundingClientRect();
      const containerRect = svg.getBoundingClientRect();

      const x1 = polRect.right - containerRect.left;
      const y1 = polRect.top + polRect.height / 2 - containerRect.top;
      const x2 = catRect.left - containerRect.left;
      const y2 = catRect.top + catRect.height / 2 - containerRect.top;

      const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
      line.setAttribute("x1", x1);
      line.setAttribute("y1", y1);
      line.setAttribute("x2", x2);
      line.setAttribute("y2", y2);
      line.setAttribute("stroke", "#666");
      line.setAttribute("stroke-width", "2");
      svg.appendChild(line);
    }
  });
}

function generaExercici(frases) {
  const polContainer = document.getElementById("polones");
  const catContainer = document.getElementById("catala");
  polContainer.innerHTML = "";
  catContainer.innerHTML = "";
  encerts = 0;
  selectedPol = null;
  actualitzaPuntuacio();

  const polFrases = barreja(frases);
  const catFrases = barreja(frases);

  polFrases.forEach(f => {
    const div = document.createElement("div");
    div.className = "item";
    div.dataset.id = f.id;
    div.textContent = f.pol;

    div.addEventListener("click", () => {
      speakPolish(f.pol); // ‚úÖ Sempre pronuncia
      if (div.classList.contains("matched") || div.classList.contains("fixed-pol")) return;
      netejaErrors();
      document.querySelectorAll("#polones .item").forEach(el => el.classList.remove("selected"));
      div.classList.add("selected");
      selectedPol = div;
    });

    polContainer.appendChild(div);
  });

  catFrases.forEach(f => {
    const div = document.createElement("div");
    div.className = "item";
    div.dataset.id = f.id;
    div.textContent = f.cat;

    div.addEventListener("click", () => {
      if (!selectedPol) return;
      if (div.classList.contains("matched") || div.classList.contains("fixed-cat")) return;

      const polId = selectedPol.dataset.id;
      const catId = div.dataset.id;

      if (polId === catId) {
        if (currentAttempts[polId] && currentAttempts[polId].attempts > 0) {
          selectedPol.classList.add("fixed-pol");
          div.classList.add("fixed-cat");
        } else {
          selectedPol.classList.add("matched");
          div.classList.add("matched");
          encerts++;
          actualitzaPuntuacio();
        }
        mouAlTop(selectedPol);
        mouAlTop(div);
        dibuixaLinies();
      } else {
        selectedPol.classList.add("incorrect-pol");
        div.classList.add("incorrect-cat");
        if (!currentAttempts[polId]) currentAttempts[polId] = { attempts: 0 };
        currentAttempts[polId].attempts++;
      }

      selectedPol.classList.remove("selected");
      selectedPol = null;
    });

    catContainer.appendChild(div);
  });
}

window.addEventListener("resize", dibuixaLinies);
window.onload = () => canviaTema();
</script>
</body>
</html>
