<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8" />
<title>Relaciona: Jocs en ga√®lic d'Irlanda</title>
<style>
body {
  font-family: 'Georgia', serif;
  max-width: 900px;
  margin: auto;
  padding: 20px;
  background: #fff;
  color: #000;
}
h1 {
  color: #003366;
  text-align: center;
}
#tema-selector {
  margin-bottom: 20px;
  background: #f4f8ff;
  padding: 15px;
  border-radius: 8px;
  border-left: 4px solid #003366;
}
#tema-selector select {
  padding: 6px;
  font-size: 14px;
  border: 1px solid #ccc;
  border-radius: 4px;
}
.match-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2em;
  padding: 20px 0;
  min-height: 400px;
  position: relative;
}
.match-lines {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}
.col {
  display: flex;
  flex-direction: column;
}
.col h3 {
  text-align: center;
  color: #003366;
  border-bottom: 2px solid #003366;
  padding-bottom: 8px;
  margin-bottom: 15px;
}
.item {
  padding: 12px;
  border: 1px solid #ccc;
  margin-bottom: 8px;
  cursor: pointer;
  user-select: none;
  transition: background-color 0.2s ease, border 0.2s ease;
  background-color: #fff;
  border-radius: 4px;
  font-size: 16px;
}
.item:hover {
  background-color: #f0f8ff;
}
.selected {
  background-color: #d0ebff;
  border: 2px solid #003366;
}
.matched {
  border: 2px solid green;
  background-color: #e8fbe8;
}
.fixed-irish {
  border: 2px solid orange;
  background-color: #fffacc !important;
}
.fixed-cat {
  border: 2px solid orange;
  background-color: #fffacc !important;
  pointer-events: none;
}
.incorrect-irish, .incorrect-cat {
  border: 2px solid red;
  background-color: #ffeaea !important;
}
#score {
  font-weight: bold;
  margin-top: 1em;
  color: #003366;
  font-size: 18px;
  text-align: center;
  padding: 10px;
  background: #f4f8ff;
  border-radius: 8px;
}
#controls {
  margin-top: 2em;
  text-align: center;
}
#controls button {
  margin: 5px 5px 15px 0;
  padding: 10px 18px;
  font-size: 16px;
  background-color: #003366;
  color: #fff;
  border: none;
  cursor: pointer;
  border-radius: 4px;
  transition: background-color 0.3s;
}
#controls button:hover {
  background-color: #005599;
}
.nota {
  margin-top: 30px;
  padding: 15px;
  background: #f4f8ff;
  border-left: 4px solid #003366;
  font-size: 14px;
  border-radius: 0 8px 8px 0;
}
.pronuncia {
  font-size: 12px;
  color: #666;
  font-style: italic;
  margin-top: 4px;
}
</style>
</head>
<body>

<h1>üåø Relaciona en ga√®lic d'Irlanda</h1>
<div id="tema-selector">
  <label for="tema">Tria un tema: </label>
  <select id="tema">
    <option value="colors">Colors</option>
    <option value="fruites">Fruites</option>
    <option value="animals">Animals</option>
    <option value="cortesia">Frases de cortesia</option>
    <option value="dies">Dies de la setmana</option>
    <option value="numeros">N√∫meros (1-10)</option>
    <option value="cos">Parts del cos</option>
    <option value="familia">Familia</option>
    <option value="verb_ser">Verb ser (a bheith)</option>
    <option value="pronoms">Pronoms personals</option>
    <option value="paisatge">Paisatge i natura</option>
    <option value="transport">Transport</option>
    <option value="menjar">Menjar i begudes</option>
    <option value="temps">Temps atmosf√®ric</option>
    <option value="ciutat">Ciutat i serveis</option>
    <option value="verb_tener">Verb tenir (a bheith ag)</option>
    <option value="adjectius">Adjectius b√†sics</option>
    <option value="interrogatius">Paraules interrogatives</option>
  </select>
  <button onclick="canviaTema()">‚úÖ Carrega tema</button>
</div>

<div class="match-container">
  <svg class="match-lines"></svg>
  <div class="col">
    <h3>Ga√®lic Irland√®s</h3>
    <div id="irlandes"></div>
  </div>
  <div class="col">
    <h3>Catal√†</h3>
    <div id="catala"></div>
  </div>
</div>

<div id="score">Encerts: 0 / 10</div>
<div id="controls">
  <button onclick="novaRonda()">üîÅ Torna a comen√ßar</button>
  <button onclick="pronunciaSeleccionat()">üîä Pronuncia seleccionat</button>
</div>

<div class="nota">
  <strong>Com jugar:</strong> Fes clic a una paraula en ga√®lic i despr√©s a la seva traducci√≥ en catal√†.<br>
  <strong>Verd</strong> = encert a la primera | <strong>Groc</strong> = encert despr√©s d'errors (es repetir√† a la seg√ºent ronda) | <strong>Vermell</strong> = error.<br>
  <em>Nota sobre pron√∫ncia: El ga√®lic irland√®s t√© una ortografia complexa amb consonants lenited (suau) i eclipsis. Els sons s√≥n diferents del catal√†.</em>
</div>

<script>
const TOTAL_PER_RONDA = 10;

const TEMES = {
  colors: [
    {"id":1,"irish":"b√°n","cat":"blanc","pron":"bawn"},
    {"id":2,"irish":"dubh","cat":"negre","pron":"duv"},
    {"id":3,"irish":"dearg","cat":"vermell","pron":"jar-ug"},
    {"id":4,"irish":"gorm","cat":"blau","pron":"gur-um"},
    {"id":5,"irish":"glas","cat":"verd (de vegetaci√≥)","pron":"gloss"},
    {"id":6,"irish":"uaine","cat":"verd (artificial)","pron":"oo-in-eh"},
    {"id":7,"irish":"bu√≠","cat":"groc","pron":"bwee"},
    {"id":8,"irish":"or√°iste","cat":"taronja","pron":"or-awsh-teh"},
    {"id":9,"irish":"corcra","cat":"porpra","pron":"kur-kruh"},
    {"id":10,"irish":"b√°ndearg","cat":"rosa","pron":"bawn-jar-ug"},
    {"id":11,"irish":"donn","cat":"marr√≥","pron":"down"},
    {"id":12,"irish":"liath","cat":"gris","pron":"lee-ah"}
  ],
  fruites: [
    {"id":1,"irish":"√∫ll","cat":"poma","pron":"ool"},
    {"id":2,"irish":"piorra","cat":"pera","pron":"pyr-uh"},
    {"id":3,"irish":"banana","cat":"pl√†tan","pron":"ban-ah-nuh"},
    {"id":4,"irish":"or√°iste","cat":"taronja","pron":"or-awsh-teh"},
    {"id":5,"irish":"l√≠om√≥id","cat":"llimona","pron":"lee-mo-ij"},
    {"id":6,"irish":"f√≠onchaor","cat":"ra√Øm","pron":"fee-un-kheer"},
    {"id":7,"irish":"s√∫ tal√∫n","cat":"maduixa","pron":"soo tah-loon"},
    {"id":8,"irish":"sil√≠n","cat":"cirera","pron":"shil-een"},
    {"id":9,"irish":"s√∫ craobh","cat":"gerd","pron":"soo kreev"},
    {"id":10,"irish":"mealbhac√°n","cat":"s√≠ndria","pron":"mal-vuh-kawn"},
    {"id":11,"irish":"anann","cat":"pinya","pron":"an-an"},
    {"id":12,"irish":"p√©itseog","cat":"pr√©ssec","pron":"pay-chog"}
  ],
  animals: [
    {"id":1,"irish":"madra","cat":"gos","pron":"mah-druh"},
    {"id":2,"irish":"cat","cat":"gat","pron":"kot"},
    {"id":3,"irish":"capall","cat":"cavall","pron":"kop-uhl"},
    {"id":4,"irish":"b√≥","cat":"vaca","pron":"boh"},
    {"id":5,"irish":"caora","cat":"ovella","pron":"keer-uh"},
    {"id":6,"irish":"gabhar","cat":"cabra","pron":"gowr"},
    {"id":7,"irish":"√©an","cat":"ocell","pron":"ayn"},
    {"id":8,"irish":"iasc","cat":"peix","pron":"eesk"},
    {"id":9,"irish":"luch","cat":"ratol√≠","pron":"lukh"},
    {"id":10,"irish":"sionnach","cat":"guineu","pron":"shun-ukh"}
  ],
  cortesia: [
    {"id":1,"irish":"t√°","cat":"s√≠","pron":"taw"},
    {"id":2,"irish":"n√≠l","cat":"no","pron":"neel"},
    {"id":3,"irish":"go raibh maith agat","cat":"gr√†cies","pron":"guh rev mah ug-ut"},
    {"id":4,"irish":"le do thoil","cat":"si us plau","pron":"leh duh hull"},
    {"id":5,"irish":"gabh mo leithsc√©al","cat":"perd√≥","pron":"gow muh leh-shkayl"},
    {"id":6,"irish":"Dia dhuit","cat":"hola (literal: D√©u amb tu)","pron":"jee-ah ghwich"},
    {"id":7,"irish":"sl√°n","cat":"ad√©u","pron":"slawn"},
    {"id":8,"irish":"maidin mhaith","cat":"bon dia","pron":"mod-in wah"},
    {"id":9,"irish":"tr√°thn√≥na maith","cat":"bona tarda","pron":"traw-noh-nuh wah"},
    {"id":10,"irish":"o√≠che mhaith","cat":"bona nit","pron":"ee-huh wah"},
    {"id":11,"irish":"f√°ilte","cat":"benvingut/da","pron":"fawl-cheh"},
    {"id":12,"irish":"sl√°inte","cat":"salut (en brindar)","pron":"slawn-cheh"}
  ],
  dies: [
    {"id":1,"irish":"D√© Luain","cat":"dilluns","pron":"jay loo-in"},
    {"id":2,"irish":"D√© M√°irt","cat":"dimarts","pron":"jay mawrt"},
    {"id":3,"irish":"D√© C√©adaoin","cat":"dimecres","pron":"jay kay-deen"},
    {"id":4,"irish":"D√©ardaoin","cat":"dijous","pron":"jayr-deen"},
    {"id":5,"irish":"D√© hAoine","cat":"divendres","pron":"jay heen-eh"},
    {"id":6,"irish":"D√© Sathairn","cat":"dissabte","pron":"jay sa-hirn"},
    {"id":7,"irish":"D√© Domhnaigh","cat":"diumenge","pron":"jay dow-nee"},
    {"id":8,"irish":"inniu","cat":"avui","pron":"in-yoo"},
    {"id":9,"irish":"am√°rach","cat":"dem√†","pron":"uh-maw-rukh"},
    {"id":10,"irish":"inn√©","cat":"ahir","pron":"in-yay"}
  ],
  numeros: [
    {"id":1,"irish":"a haon","cat":"1","pron":"uh hayn"},
    {"id":2,"irish":"a d√≥","cat":"2","pron":"uh doh"},
    {"id":3,"irish":"a tr√≠","cat":"3","pron":"uh tree"},
    {"id":4,"irish":"a ceathair","cat":"4","pron":"uh kah-her"},
    {"id":5,"irish":"a c√∫ig","cat":"5","pron":"uh koo-ig"},
    {"id":6,"irish":"a s√©","cat":"6","pron":"uh shay"},
    {"id":7,"irish":"a seacht","cat":"7","pron":"uh shakht"},
    {"id":8,"irish":"a hocht","cat":"8","pron":"uh hukht"},
    {"id":9,"irish":"a naoi","cat":"9","pron":"uh nee"},
    {"id":10,"irish":"a deich","cat":"10","pron":"uh jeh"}
  ],
  cos: [
    {"id":1,"irish":"ceann","cat":"cap","pron":"kyaun"},
    {"id":2,"irish":"l√°mh","cat":"m√†","pron":"lawv"},
    {"id":3,"irish":"cos","cat":"cama","pron":"kuss"},
    {"id":4,"irish":"s√∫il","cat":"ull","pron":"sool"},
    {"id":5,"irish":"cluas","cat":"orella","pron":"kloos"},
    {"id":6,"irish":"sr√≥n","cat":"nas","pron":"srohn"},
    {"id":7,"irish":"b√©al","cat":"boca","pron":"bayl"},
    {"id":8,"irish":"cro√≠","cat":"cor","pron":"kree"},
    {"id":9,"irish":"droim","cat":"esquena","pron":"drim"},
    {"id":10,"irish":"fiacla","cat":"dent","pron":"fee-uh-kluh"}
  ],
  familia: [
    {"id":1,"irish":"m√°thair","cat":"mare","pron":"maw-her"},
    {"id":2,"irish":"athair","cat":"pare","pron":"ah-her"},
    {"id":3,"irish":"deirfi√∫r","cat":"germana","pron":"der-fyoor"},
    {"id":4,"irish":"dearth√°ir","cat":"germ√†","pron":"jar-hawr"},
    {"id":5,"irish":"in√≠on","cat":"filla","pron":"in-yun"},
    {"id":6,"irish":"mac","cat":"fill","pron":"mok"},
    {"id":7,"irish":"seanmh√°thair","cat":"√†via","pron":"shan-vaw-her"},
    {"id":8,"irish":"seanathair","cat":"avi","pron":"shan-ah-her"},
    {"id":9,"irish":"uncail","cat":"oncle","pron":"un-kul"},
    {"id":10,"irish":"aint√≠n","cat":"tia","pron":"an-cheen"}
  ],
  verb_ser: [
    {"id":1,"irish":"t√° m√©","cat":"jo s√≥c","pron":"taw may"},
    {"id":2,"irish":"t√° t√∫","cat":"tu ets","pron":"taw too"},
    {"id":3,"irish":"t√° s√©","cat":"ell √©s","pron":"taw shay"},
    {"id":4,"irish":"t√° s√≠","cat":"ella √©s","pron":"taw shee"},
    {"id":5,"irish":"t√° muid","cat":"nosaltres som","pron":"taw mij"},
    {"id":6,"irish":"t√° sibh","cat":"vosaltres sou","pron":"taw shiv"},
    {"id":7,"irish":"t√° siad","cat":"ells s√≥n","pron":"taw sheed"},
    {"id":8,"irish":"n√≠l m√©","cat":"jo no s√≥c","pron":"neel may"},
    {"id":9,"irish":"an bhfuil t√∫?","cat":"ets tu?","pron":"on wil too"},
    {"id":10,"irish":"nach bhfuil s√©?","cat":"no √©s ell?","pron":"nakh wil shay"}
  ],
  pronoms: [
    {"id":1,"irish":"m√©","cat":"jo","pron":"may"},
    {"id":2,"irish":"t√∫","cat":"tu","pron":"too"},
    {"id":3,"irish":"s√©","cat":"ell","pron":"shay"},
    {"id":4,"irish":"s√≠","cat":"ella","pron":"shee"},
    {"id":5,"irish":"muid","cat":"nosaltres","pron":"mwij"},
    {"id":6,"irish":"sibh","cat":"vosaltres","pron":"shiv"},
    {"id":7,"irish":"siad","cat":"ells/elles","pron":"sheed"},
    {"id":8,"irish":"√©","cat":"ell (objecte)","pron":"ay"},
    {"id":9,"irish":"√≠","cat":"ella (objecte)","pron":"ee"},
    {"id":10,"irish":"iad","cat":"ells/elles (objecte)","pron":"eed"}
  ],
  paisatge: [
    {"id":1,"irish":"sliabh","cat":"muntanya","pron":"shlee-uv"},
    {"id":2,"irish":"abhainn","cat":"riu","pron":"ow-in"},
    {"id":3,"irish":"loch","cat":"llac","pron":"lukh"},
    {"id":4,"irish":"farraige","cat":"mar","pron":"far-uh-geh"},
    {"id":5,"irish":"coill","cat":"bosc","pron":"kwil"},
    {"id":6,"irish":"machaire","cat":"camp","pron":"mah-her-eh"},
    {"id":7,"irish":"tr√°","cat":"platja","pron":"traw"},
    {"id":8,"irish":"oile√°n","cat":"illa","pron":"ul-awn"},
    {"id":9,"irish":"gleann","cat":"vall","pron":"glyaun"},
    {"id":10,"irish":"cnoc","cat":"tur√≥","pron":"kruk"}
  ],
  transport: [
    {"id":1,"irish":"carr","cat":"cotxe","pron":"kor"},
    {"id":2,"irish":"bus","cat":"autob√∫s","pron":"buss"},
    {"id":3,"irish":"traein","cat":"tren","pron":"tray-in"},
    {"id":4,"irish":"rothar","cat":"bicicleta","pron":"ruh-her"},
    {"id":5,"irish":"b√°d","cat":"vaixell","pron":"bawd"},
    {"id":6,"irish":"eitle√°n","cat":"avi√≥","pron":"et-lawn"},
    {"id":7,"irish":"st√°isi√∫n","cat":"estaci√≥","pron":"staw-shoon"},
    {"id":8,"irish":"aerfort","cat":"aeroport","pron":"ayr-furt"},
    {"id":9,"irish":"droichead","cat":"pont","pron":"drikh-ud"},
    {"id":10,"irish":"b√≥thar","cat":"carretera","pron":"boh-her"}
  ],
  menjar: [
    {"id":1,"irish":"ar√°n","cat":"pa","pron":"aw-rawn"},
    {"id":2,"irish":"im","cat":"mantega","pron":"im"},
    {"id":3,"irish":"uisce","cat":"aigua","pron":"ish-keh"},
    {"id":4,"irish":"bainne","cat":"llet","pron":"bon-yeh"},
    {"id":5,"irish":"feoil","cat":"carn","pron":"fyohl"},
    {"id":6,"irish":"iasc","cat":"peix","pron":"eesk"},
    {"id":7,"irish":"glasra√≠","cat":"verdures","pron":"gloss-ree"},
    {"id":8,"irish":"tortha√≠","cat":"fruites","pron":"tur-hee"},
    {"id":9,"irish":"caife","cat":"caf√®","pron":"kaf-eh"},
    {"id":10,"irish":"tae","cat":"te","pron":"tay"}
  ],
  temps: [
    {"id":1,"irish":"grian","cat":"sol","pron":"gree-un"},
    {"id":2,"irish":"scamall","cat":"n√∫vol","pron":"skom-uhl"},
    {"id":3,"irish":"b√°isteach","cat":"pluja","pron":"bawsh-tukh"},
    {"id":4,"irish":"sneachta","cat":"neu","pron":"shnakht-uh"},
    {"id":5,"irish":"gaoth","cat":"vent","pron":"ghee"},
    {"id":6,"irish":"toirneach","cat":"tro","pron":"tirn-ukh"},
    {"id":7,"irish":"tuar ceatha","cat":"arc de Sant Mart√≠","pron":"too-er kah-huh"},
    {"id":8,"irish":"doineann","cat":"tempesta","pron":"din-yun"},
    {"id":9,"irish":"te","cat":"calent","pron":"cheh"},
    {"id":10,"irish":"fuar","cat":"fred","pron":"foo-er"}
  ],
  ciutat: [
    {"id":1,"irish":"cathair","cat":"ciutat","pron":"kah-her"},
    {"id":2,"irish":"sr√°id","cat":"carrer","pron":"srawd"},
    {"id":3,"irish":"siopa","cat":"botiga","pron":"shup-uh"},
    {"id":4,"irish":"banc","cat":"banc","pron":"bonk"},
    {"id":5,"irish":"ospid√©al","cat":"hospital","pron":"uss-pee-dawl"},
    {"id":6,"irish":"scoil","cat":"escola","pron":"skul"},
    {"id":7,"irish":"leabharlann","cat":"biblioteca","pron":"lour-un"},
    {"id":8,"irish":"p√°irc","cat":"parc","pron":"pawrk"},
    {"id":9,"irish":"teach √≥sta","cat":"pub","pron":"chakh ohs-tuh"},
    {"id":10,"irish":"√≥st√°n","cat":"hotel","pron":"ohs-tawn"}
  ],
  verb_tener: [
    {"id":1,"irish":"t√° ... agam","cat":"jo tinc","pron":"taw ... og-um"},
    {"id":2,"irish":"t√° ... agat","cat":"tu tens","pron":"taw ... og-ut"},
    {"id":3,"irish":"t√° ... aige","cat":"ell t√©","pron":"taw ... eg-eh"},
    {"id":4,"irish":"t√° ... aici","cat":"ella t√©","pron":"taw ... ek-ee"},
    {"id":5,"irish":"t√° ... againn","cat":"nosaltres tenim","pron":"taw ... og-in"},
    {"id":6,"irish":"t√° ... agaibh","cat":"vosaltres teniu","pron":"taw ... og-iv"},
    {"id":7,"irish":"t√° ... acu","cat":"ells tenen","pron":"taw ... ok-oo"},
    {"id":8,"irish":"n√≠l ... agam","cat":"jo no tinc","pron":"neel ... og-um"},
    {"id":9,"irish":"an bhfuil ... agat?","cat":"tens tu ...?","pron":"on wil ... og-ut"},
    {"id":10,"irish":"nach bhfuil ... aige?","cat":"no t√© ell ...?","pron":"nakh wil ... eg-eh"}
  ],
  adjectius: [
    {"id":1,"irish":"m√≥r","cat":"gran","pron":"mor"},
    {"id":2,"irish":"beag","cat":"petit","pron":"byug"},
    {"id":3,"irish":"√°lainn","cat":"bonic","pron":"aw-lin"},
    {"id":4,"irish":"dona","cat":"dolent","pron":"dun-uh"},
    {"id":5,"irish":"maith","cat":"bo","pron":"mah"},
    {"id":6,"irish":"nua","cat":"nou","pron":"noo-uh"},
    {"id":7,"irish":"sean","cat":"vell","pron":"shan"},
    {"id":8,"irish":"deas","cat":"agradable","pron":"jas"},
    {"id":9,"irish":"olc","cat":"malici√≥s","pron":"ulk"},
    {"id":10,"irish":"tirim","cat":"sec","pron":"tir-im"}
  ],
  interrogatius: [
    {"id":1,"irish":"c√©","cat":"qui","pron":"kay"},
    {"id":2,"irish":"cad","cat":"qu√®","pron":"kod"},
    {"id":3,"irish":"cathain","cat":"quan","pron":"kah-hin"},
    {"id":4,"irish":"c√©n f√°th","cat":"per qu√®","pron":"kayn faw"},
    {"id":5,"irish":"conas","cat":"com","pron":"kun-us"},
    {"id":6,"irish":"c√° h√°it","cat":"on","pron":"kaw hawtch"},
    {"id":7,"irish":"c√© mh√©ad","cat":"quant","pron":"kay vayd"},
    {"id":8,"irish":"c√©n","cat":"quin","pron":"kayn"},
    {"id":9,"irish":"c√© acu","cat":"quin dels dos","pron":"kay ok-oo"},
    {"id":10,"irish":"cad √© mar at√°","cat":"com est√†s","pron":"kod ay mar uh-taw"}
  ]
};

let frasesActuals = TEMES.colors;
let encerts = 0;
let selectedIrish = null;
let currentAttempts = {};

function canviaTema() {
  frasesActuals = TEMES[document.getElementById("tema").value];
  novaRonda();
}

function barreja(array) {
  return array.slice().sort(() => Math.random() - 0.5);
}

function speakIrish(text) {
  // Simulaci√≥ de pron√∫ncia amb s√≠ntesi de veu gen√®rica
  // Nota: la s√≠ntesi de veu per al ga√®lic irland√®s no est√† √†mpliament disponible
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = "ga-IE"; // Intentem amb el codi d'irland√®s
  utterance.rate = 0.8;
  speechSynthesis.cancel();
  speechSynthesis.speak(utterance);
}

function pronunciaSeleccionat() {
  if (selectedIrish) {
    const text = selectedIrish.textContent.split('\n')[0]; // Agafa nom√©s el text principal
    speakIrish(text);
  } else {
    alert("Selecciona primer una paraula en ga√®lic");
  }
}

function actualitzaPuntuacio() {
  document.getElementById("score").textContent = `Encerts: ${encerts} / ${TOTAL_PER_RONDA}`;
}

function novaRonda() {
  const grogues = [];
  document.querySelectorAll(".fixed-irish").forEach(el => {
    grogues.push(parseInt(el.dataset.id));
  });

  const restants = frasesActuals.filter(f => !grogues.includes(f.id));
  const seleccionades = [];

  grogues.forEach(id => {
    const paraula = frasesActuals.find(f => f.id === id);
    if (paraula) seleccionades.push(paraula);
  });

  const addicionals = barreja(restants).slice(0, TOTAL_PER_RONDA - seleccionades.length);
  seleccionades.push(...addicionals);

  currentAttempts = {};
  generaExercici(seleccionades);
  dibuixaLinies();
}

function netejaErrors() {
  document.querySelectorAll(".incorrect-irish, .incorrect-cat").forEach(el => {
    el.classList.remove("incorrect-irish", "incorrect-cat");
  });
}

function mouAlTop(element) {
  const parent = element.parentNode;
  parent.insertBefore(element, parent.firstChild);
}

function dibuixaLinies() {
  const svg = document.querySelector(".match-lines");
  svg.innerHTML = "";
  const irishContainer = document.getElementById("irlandes");
  const catContainer = document.getElementById("catala");

  const matchedIrish = irishContainer.querySelectorAll(".matched, .fixed-irish");
  matchedIrish.forEach(irish => {
    const irishId = irish.dataset.id;
    const cat = catContainer.querySelector(`.matched[data-id="${irishId}"], .fixed-cat[data-id="${irishId}"]`);
    if (cat) {
      const irishRect = irish.getBoundingClientRect();
      const catRect = cat.getBoundingClientRect();
      const containerRect = svg.getBoundingClientRect();

      const x1 = irishRect.right - containerRect.left;
      const y1 = irishRect.top + irishRect.height / 2 - containerRect.top;
      const x2 = catRect.left - containerRect.left;
      const y2 = catRect.top + catRect.height / 2 - containerRect.top;

      const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
      line.setAttribute("x1", x1);
      line.setAttribute("y1", y1);
      line.setAttribute("x2", x2);
      line.setAttribute("y2", y2);
      line.setAttribute("stroke", "#003366");
      line.setAttribute("stroke-width", "2");
      line.setAttribute("stroke-dasharray", "5,3");
      svg.appendChild(line);
    }
  });
}

function generaExercici(frases) {
  const irishContainer = document.getElementById("irlandes");
  const catContainer = document.getElementById("catala");
  irishContainer.innerHTML = "";
  catContainer.innerHTML = "";
  encerts = 0;
  selectedIrish = null;
  actualitzaPuntuacio();

  const irishFrases = barreja(frases);
  const catFrases = barreja(frases);

  irishFrases.forEach(f => {
    const div = document.createElement("div");
    div.className = "item";
    div.dataset.id = f.id;
    
    const textDiv = document.createElement("div");
    textDiv.textContent = f.irish;
    
    const pronDiv = document.createElement("div");
    pronDiv.className = "pronuncia";
    pronDiv.textContent = `Pron√∫ncia: ${f.pron}`;
    
    div.appendChild(textDiv);
    div.appendChild(pronDiv);

    div.addEventListener("click", () => {
      speakIrish(f.irish);
      if (div.classList.contains("matched") || div.classList.contains("fixed-irish")) return;
      netejaErrors();
      document.querySelectorAll("#irlandes .item").forEach(el => el.classList.remove("selected"));
      div.classList.add("selected");
      selectedIrish = div;
    });

    irishContainer.appendChild(div);
  });

  catFrases.forEach(f => {
    const div = document.createElement("div");
    div.className = "item";
    div.dataset.id = f.id;
    div.textContent = f.cat;

    div.addEventListener("click", () => {
      if (!selectedIrish) return;
      if (div.classList.contains("matched") || div.classList.contains("fixed-cat")) return;

      const irishId = selectedIrish.dataset.id;
      const catId = div.dataset.id;

      if (irishId === catId) {
        if (currentAttempts[irishId] && currentAttempts[irishId].attempts > 0) {
          selectedIrish.classList.add("fixed-irish");
          div.classList.add("fixed-cat");
        } else {
          selectedIrish.classList.add("matched");
          div.classList.add("matched");
          encerts++;
          actualitzaPuntuacio();
        }
        mouAlTop(selectedIrish);
        mouAlTop(div);
        dibuixaLinies();
      } else {
        selectedIrish.classList.add("incorrect-irish");
        div.classList.add("incorrect-cat");
        if (!currentAttempts[irishId]) currentAttempts[irishId] = { attempts: 0 };
        currentAttempts[irishId].attempts++;
      }

      selectedIrish.classList.remove("selected");
      selectedIrish = null;
    });

    catContainer.appendChild(div);
  });
}

window.addEventListener("resize", dibuixaLinies);
window.onload = () => canviaTema();
</script>
</body>
  </html>
